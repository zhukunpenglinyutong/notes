# 2019.6.3 - 2019.6.9ï¼ˆå½’æ¡£ï¼‰

### 2019.6.3

---

##### æ”¶è·ä¸€

- éœ€æ±‚ï¼šè°ƒç”¨æ‰“å°ç‰¹å®šåŒºåŸŸï¼ˆå°±æ˜¯ç‰¹å®šæ ‡ç­¾å†…ï¼‰çš„å†…å®¹ï¼Œä¾‹å¦‚æ‰“å° bodyä¸‹é¢ idä¸º con æ ‡ç­¾é‡Œé¢çš„å†…å®¹

---

##### è§£å†³è¿‡ç¨‹

- ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆæ˜¯ç”¨åŸç”Ÿçš„æ–¹æ³• print()ï¼Œä½†æ˜¯æœ‰ css æ ·å¼æ‰“å°ä¸å‡ºæ¥çš„é—®é¢˜
- ç¬¬äºŒæ­¥ï¼šå¯»æ‰¾ç¬¬ä¸‰æ–¹åº“ï¼Œæ‰¾åˆ°ä¸€ä¸ªå«åš print-jsçš„åº“ï¼Œä½†æ˜¯å¯æƒœï¼Œåœ¨ vue-cli3.0 ä¸‹ï¼Œæ‰“åŒ…å‡ºçš„csséƒ½æ•£æˆä¸€å—å—çš„ï¼Œäºæ˜¯æ ·å¼ä¹Ÿæ˜¯æ‰“å°ä¸å‡ºæ¥ï¼ˆä½†æ˜¯è‡ªå·±è¯•éªŒçš„æ ·å¼å¯ä»¥æ˜¾ç¤ºå‡ºæ¥ï¼Œæ•´ä½“æ¥è¯´æ¯”ç¬¬ä¸€æ­¥æœ‰äº†æå‡ï¼‰
- ç¬¬ä¸‰æ­¥ï¼šå°†åŒºåŸŸå†…å®¹è½¬ä¸º å›¾ç‰‡ï¼Œé‡‡ç”¨ html2canvas è¿™ä¸ªåº“ï¼Œå®é™…ç»“æœå¯è¡Œï¼ˆå›¾ç‰‡æœ‰éƒ¨åˆ†åå·®ä½†æ˜¯ä¸å½±å“ï¼‰

```javascript

// html2canvaså·²ç»æŒ‚åˆ°äº†windowä¸Š

function downloadClick() { // ä¸‹è½½æŒ‰é’®ç‚¹å‡»è§¦å‘

    html2canvas(document.querySelector("#downloadImgMain"), {
        allowTaint: true, //å…è®¸æ±¡æŸ“
        taintTest: true, //åœ¨æ¸²æŸ“å‰æµ‹è¯•å›¾ç‰‡(æ²¡æ•´æ˜ç™½æœ‰å•¥ç”¨)
        useCORS: true, //ä½¿ç”¨è·¨åŸŸ(å½“allowTaintä¸ºtrueæ—¶è¿™æ®µä»£ç æ²¡ä»€ä¹ˆç”¨)

    }).then(canvas => {
        // ä¸‹è½½
        let type = 'png';   //è®¾ç½®ä¸‹è½½å›¾ç‰‡çš„æ ¼å¼
        let img_png_src = canvas.toDataURL("image/png");  //å°†canvasä¿å­˜ä¸ºå›¾ç‰‡
        let imgData = img_png_src.replace(imgType(type),'image/octet-stream');
        let filename = 'å›¾ç‰‡' + '.' + type; //ä¸‹è½½å›¾ç‰‡çš„æ–‡ä»¶å
        saveFile(imgData, filename);
    });
}

function imgType (ty) {
  let type = ty.toLowerCase().replace(/jpg/i, 'jpeg');
  let r = type.match(/png|jpeg|bmp|gif/)[0];
  return 'image/' + r;
}

function saveFile (data, fileName) {
  let save_link = document.createElement('a');
  save_link.href = data;
  save_link.download = fileName;
  let event = document.createEvent('MouseEvents');
  event.initEvent("click", true, false);
  save_link.dispatchEvent(event);
};
```

---

### 2019.6.4

##### æ”¶è·ä¸€ï¼šä¸»è¦æ˜¯å°† GitHub/notes é¡¹ç›®å®Œå–„äº†ä¸€ä¸‹

- æ•´ç†äº† æ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥
- å®Œå–„äº† notesçš„æ•´ä½“ç»“æ„å¸ƒå±€
- å°è¯•äº†ç¤¾åŒºçš„ä¸€äº›åŠŸèƒ½ï¼ˆåæ¥åˆå–æ¶ˆäº†ï¼‰

---

### 2019.6.5

##### BUGè®°å½•ï¼šå·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªbugï¼Œè®°å½•ä¸‹ï¼Œä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æˆ‘æ²¡çœ‹åˆ°ï¼Œæ‰€ä»¥æˆ‘è®°å½•ä¸€ä¸‹ï¼ˆ2019.6.5 11:46ï¼‰

```javascript

// æŠ½è±¡å‡ºæ¥å°±æ˜¯è¿™ä¸ªæ„æ€
let obj = {}
obj['a']['b'] = 1; // æŠ¥é”™

// è§£å†³ç›®å‰å°±æ˜¯ç»™ obj.a = {}

```

---


### 2019.6.8

ä»Šå¤©ä¸»è¦å¹²äº†ä¸¤ä»¶äº‹æƒ…ï¼š

##### 1.æ¢³ç†äº†VuePressçš„è§„åˆ™ï¼ŒçŸ¥é“æ€ä¹ˆé…ç½®å¤šä¸ªä¾§è¾¹æ 

```javascript
module.exports = {
  // base: '/documents/',
  title: 'Notes',
  description: 'çŸ¥è¯†é€ŸæŸ¥ï¼ˆäº†ä¸èµ·çš„ä¸ªäººå·¥å…·åº“',
  head: [
    ['link', { rel: 'icon', href: `/favicon.ico` }]
  ],
  themeConfig: {
    repo: 'https://github.com/zhukunpenglinyutong/notes',
    //å¯¼èˆª
    nav: [
      { text: 'é€ŸæŸ¥', link: '/1.quickcheck/' },
      { text: 'ç¬”è®°', link: '/2.note/' },
      // { text: 'å¸¸ç”¨ç½‘ç«™', link: '/webtool/' }
    ],
    // ä¾§è¾¹æ 
    sidebar: {
      '/1.quickcheck': [
        {
          title: '1.å‰ç«¯',
          children: [
            '/1.quickcheck/1.å‰ç«¯/1.HTMLé€ŸæŸ¥.md',
            '/1.quickcheck/1.å‰ç«¯/2.CSSé€ŸæŸ¥.md',
            '/1.quickcheck/1.å‰ç«¯/3.JSæ–¹æ³•é€ŸæŸ¥.md'
          ]
        },
        {
          title: '2.åç«¯',
          children: [
            '/1.quickcheck/2.åç«¯/1.Nodeé€ŸæŸ¥.md',
            '/1.quickcheck/2.åç«¯/2.MySQLé€ŸæŸ¥.md',
            '/1.quickcheck/2.åç«¯/3.Expressé€ŸæŸ¥.md',
            '/1.quickcheck/2.åç«¯/4.MongoDBé€ŸæŸ¥.md'
          ]
        },
        {
          title: '3.è¿ç»´',
          children: [
            '/1.quickcheck/3.è¿ç»´/1.Centosä¸‹å®‰è£…å„ç§è½¯ä»¶.md',
            '/1.quickcheck/3.è¿ç»´/2.Nginxé€ŸæŸ¥.md',
            '/1.quickcheck/3.è¿ç»´/3.pm2å¸¸ç”¨å‘½ä»¤.md',
            '/1.quickcheck/3.è¿ç»´/4.Dockeré€ŸæŸ¥.md'
          ]
        },
        {
          title: '4.å…¶ä»–',
          children: [
            '/1.quickcheck/4.å…¶ä»–/1.æ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥.md',
            '/1.quickcheck/4.å…¶ä»–/2.GitHubå¹³å°.md',
            '/1.quickcheck/4.å…¶ä»–/3.httpåè®®é€ŸæŸ¥.md',
            '/1.quickcheck/4.å…¶ä»–/4.å¾®ä¿¡å°ç¨‹åºçŸ¥è¯†é€ŸæŸ¥.md',
            '/1.quickcheck/4.å…¶ä»–/5.å‰ç«¯å®‰å…¨é€ŸæŸ¥.md',
            '/1.quickcheck/4.å…¶ä»–/6.Electroné€ŸæŸ¥.md',
            '/1.quickcheck/4.å…¶ä»–/7.VuePressé€ŸæŸ¥.md',
          ]
        },
      ],
      '/2.note': [
        {
          title: '0.é¡¹ç›®æ–¹å‘æŒ‡å—',
          children: [
            '/2.note/0.é¡¹ç›®æ–¹å‘æŒ‡å—/v0.1æ–¹å‘æŒ‡å—',
            '/2.note/0.é¡¹ç›®æ–¹å‘æŒ‡å—/v0.2æ–¹å‘æŒ‡å—'
          ]
        },
        {
          title: '1.æ¯æ—¥è§„åˆ’',
          children: [
            '/2.note/1.æ¯æ—¥è§„åˆ’/2019.6.4.md',
            '/2.note/1.æ¯æ—¥è§„åˆ’/2019.6.5',
            '/2.note/1.æ¯æ—¥è§„åˆ’/2019.6.7',
            '/2.note/1.æ¯æ—¥è§„åˆ’/2019.6.8',
          ]
        },
        {
          title: '2.æ¯æ—¥æ”¶è·',
          children: [
            '/2.note/2.æ¯æ—¥æ”¶è·/2019.6.3',
            '/2.note/2.æ¯æ—¥æ”¶è·/2019.6.4',
            '/2.note/2.æ¯æ—¥æ”¶è·/2019.6.5'
          ]
        },
        {
          title: '3.é¢è¯•æ€»ç»“',
          children: [
            '/2.note/3.é¢è¯•æ€»ç»“/1.å…¬å¸'
          ]
        },
        {
          title: '4.Typescript',
          children: [
            '/2.note/4.Typescript/1.æ¦‚è¿°'
          ]
        }
      ]
    }
  },
  serviceWorker: true,
}
```


##### 2.å†™äº†Nodeç¨‹åºï¼Œè§£æ”¾äº†è‡ªå·±å¤§éƒ¨åˆ†çš„ç”Ÿäº§åŠ›ï¼ˆnodeç¨‹åºè¿˜å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼‰


```javascript
var fs = require("fs");
var path = require('path')

// â‘  ï¼šå°† record.md å†…å®¹å¤åˆ¶åˆ° 1.quickcheck å’Œ 2.noteä¸‹ï¼Œå¹¶ä¸”åå­—éƒ½å«åš README.md

// å¼‚æ­¥è¯»å–
fs.readFile('record.md', function (err, data) {
  
  if (err) {
      return console.error(err);
  }
  // console.log("å¼‚æ­¥è¯»å–: " + data.toString());

  // å¼‚æ­¥å†™å…¥
  fs.writeFile('./docs/1.quickcheck/README.md', data,  function(err) {
    if (err) {
        return console.error(err);
    }
    console.log("2.quickcheck README.md æ•°æ®å†™å…¥æˆåŠŸï¼");
  });

  fs.writeFile('./docs/2.note/README.md', data,  function(err) {
    if (err) {
        return console.error(err);
    }
    console.log("3.note README.md æ•°æ®å†™å…¥æˆåŠŸï¼");
  });

});


// â‘¡ éå† 1.quickcheck å’Œ 2.note æ–‡ä»¶å¤¹ï¼Œç”Ÿæˆè·¯å¾„å¯¼èˆª

// è¯»å–ç›®å½•,å¹¶æ ¹æ®æ­¤ç”Ÿæˆè§„åˆ™å†™å…¥ config.jsä¸­
let strOne = ''
let one = fs.readdirSync('./1.quickcheck')
one.forEach(item => {
  if (!/.md/.test(item) && item !== '.DS_Store') {

    let files2 = []
    let files2Str = ''
    fs.readdirSync(path.join('./1.quickcheck', item)).forEach( item1 => {
      files2.push(`${path.join(path.join('./1.quickcheck', item), item1)}`)
    })

    files2.forEach( item2 => {
      files2Str += `
      '${item2}',`
    })

    strOne += `
      {
        title: '${item}',
        children: [${files2Str}]
      },
    `
  }
})

let strTwo = ''
let two = fs.readdirSync('./2.note')
two.forEach(item => {
  if (!/.md/.test(item) && item !== '.DS_Store') {

    let files2 = []
    let files2Str = ''
    fs.readdirSync(path.join('./2.note', item)).forEach( item1 => {
      files2.push(`${path.join(path.join('./2.note', item), item1)}`)
    })

    files2.forEach( item2 => {
      files2Str += `
      '${item2}',`
    })

    strTwo += `
      {
        title: '${item}',
        children: [${files2Str}]
      },
    `
  }
})

// å†™å…¥
let configStr = `
module.exports = {
  title: 'Notes',
  description: 'çŸ¥è¯†é€ŸæŸ¥ï¼ˆäº†ä¸èµ·çš„ä¸ªäººå·¥å…·åº“ï¼‰',
  head: [
    ['link', { rel: 'icon', href: '/favicon.ico' }]
  ],
  themeConfig: {
    repo: 'https://github.com/zhukunpenglinyutong/notes',
    //å¯¼èˆª
    nav: [
      { text: 'é€ŸæŸ¥', link: '/1.quickcheck/' },
      { text: 'ç¬”è®°', link: '/2.note/' }
    ],
    // ä¾§è¾¹æ 
    sidebar: {
      '/1.quickcheck': [
        ${strOne}
      ],
      '/2.note': [
        ${strTwo}
      ]
    }
  },
  serviceWorker: true,
}
`

fs.writeFile('./docs/.vuepress/config.js', configStr,  function(err) {
  if (err) {
      return console.error(err);
  }
  console.log("1.configStr æ•°æ®å†™å…¥æˆåŠŸï¼");
});
```

### 2019.6.9

##### 1.ç”³è¯·é…ç½®sslè¯ä¹¦

- ç”³è¯·äº†sslè¯ä¹¦ï¼Œå°±èƒ½è®©ç½‘ç«™å˜ä¸º httpså¼€å¤´çš„ï¼Œæ›´å®‰å…¨ï¼Œé¢ï¼Œä¼¼ä¹æ¯”æˆ‘æƒ³çš„ç®€å•

<img src="https://itzkp-1253302184.cos.ap-beijing.myqcloud.com/notes/1.quickcheck/3.%E8%BF%90%E7%BB%B4/1.png" />
<img src="https://itzkp-1253302184.cos.ap-beijing.myqcloud.com/notes/1.quickcheck/3.%E8%BF%90%E7%BB%B4/2.png" />
<img src="https://itzkp-1253302184.cos.ap-beijing.myqcloud.com/notes/1.quickcheck/3.%E8%BF%90%E7%BB%B4/3.png" />

- ä¹‹åè¿˜éœ€è¦è¿›è¡Œé…ç½®ï¼šhttps://cloud.tencent.com/document/product/400/35244

<img src="https://itzkp-1253302184.cos.ap-beijing.myqcloud.com/notes/1.quickcheck/3.%E8%BF%90%E7%BB%B4/4.png" />

- ğŸ”¥æ³¨æ„ï¼šä¸»åŸŸåç”³è¯·çš„å•åŸŸåè¯ä¹¦ï¼ŒäºŒçº§åŸŸåä¸åœ¨httpsåŠ å¯†ä¿æŠ¤å†…ï¼Œæ‰€ä»¥ notes.itzkp.com è¿˜æ˜¯ httpåè®®ï¼Œè€Œé€šé…ç¬¦è¯ä¹¦å¯ä»¥ä¿æŠ¤ä¸»åŸŸåä¸‹æ‰€æœ‰çš„äºŒçº§å­åŸŸå

äºæ˜¯ä¹æˆ‘åˆç”³è¯·äº†ï¼šnotes.itzkp.com å’Œ jl.itzkp.com çš„sslè¯ä¹¦ï¼Œéš¾ç‚¹å°±æ˜¯ äºŒçº§åŸŸåçš„è§£ææˆ‘æ˜¯æ”¾åˆ°äº†ï¼Œconf.d æ–‡ä»¶å¤¹ä¸‹ï¼Œæˆ‘è¿™æ€ä¹ˆè®¾ç½® sslå‘¢ï¼Ÿ

```sh
# ç¤ºä¾‹ï¼šåœ¨conf.d ä¸‹é¢çš„ notes.confä¸‹

server {
	listen 443;
    server_name notes.itzkp.com; #å¡«å†™ç»‘å®šè¯ä¹¦çš„åŸŸå
    ssl on;
    ssl_certificate 1_notes.itzkp.com_bundle.crt;#è¯ä¹¦æ–‡ä»¶åç§°
    ssl_certificate_key 2_notes.itzkp.com.key;#ç§é’¥æ–‡ä»¶åç§°
    ssl_session_timeout 5m;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #è¯·æŒ‰ç…§è¿™ä¸ªåè®®é…ç½®
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;#è¯·æŒ‰ç…§è¿™ä¸ªå¥—ä»¶é…ç½®
    ssl_prefer_server_ciphers on;

    location / {

      proxy_pass http://140.143.3.244:9998;
    	proxy_set_header X-Real-IP $remote_addr;
   	 	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
   	  proxy_set_header Host $http_host;
  		proxy_set_header X-Nginx-Proxy true;
  		proxy_redirect off;        
    }
}

server {
  listen 80;
  server_name notes.itzkp.com; #å¡«å†™ç»‘å®šè¯ä¹¦çš„åŸŸå
  rewrite ^(.*)$ https://$host$1 permanent; #æŠŠhttpçš„åŸŸåè¯·æ±‚è½¬æˆhttps
}

```

---