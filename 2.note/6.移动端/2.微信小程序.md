# 2.å¾®ä¿¡å°ç¨‹åº

## ğŸ¬ç¬¬ä¸€éƒ¨åˆ†ï¼šå¾®ä¿¡å°ç¨‹åºæ ¸å¿ƒç†å¿µï¼Œä»¥åŠåŸºç¡€å¼€å‘ä»‹ç»

### 1.å¾®ä¿¡å°ç¨‹åºæ ¸å¿ƒç†å¿µä»‹ç»

---

### 2.å¾®ä¿¡å°ç¨‹åºå¼€å‘ä»‹ç»

---

### 3.å¾®ä¿¡å°ç¨‹åºç›®å½•ç»“æ„ä»‹ç»

---

### ğŸ”¥4.å¾®ä¿¡å°ç¨‹åºåŸºç¡€é…ç½®ä»‹ç»

---

## ğŸ³ç¬¬äºŒéƒ¨åˆ†ï¼šWXML

**WXMLç”¨æ³•ä¸Šå’ŒHTMLä¸€æ ·ï¼Œå°±æ˜¯æ ‡ç­¾ï¼ˆå°ç¨‹åºé‡Œé¢æ˜¯å«ç»„ä»¶ï¼‰åç§°ä¸ä¸€æ ·**

### 1.WXMLåŸºç¡€

- WXML å…¨ç§° WeiXin Markup Languageï¼Œæ˜¯å°ç¨‹åºè®¾è®¡çš„ä¸€å¥—æ ‡ç­¾è¯­è¨€ï¼ˆè™½ç„¶ç”¨æ³•å’ŒHTMLç›¸ä¼¼ï¼Œä½†æ˜¯ä¸æ˜¯HTMLï¼‰
- é¦–å…ˆè¦æ˜ç¡®ä¸€ç‚¹ï¼Œåœ¨å°ç¨‹åºä¸­ä¹¦å†™ æ ‡ç­¾ï¼ˆæˆ–è€…å«ç»„ä»¶ï¼‰ï¼Œä¸ºä»€ä¹ˆèƒ½å±•ç¤ºå‡ºæ¥ï¼Œæ˜¯å› ä¸ºå¾®ä¿¡çš„æ¸²æŸ“å¼•æ“å’Œè„šæœ¬å¼•æ“ï¼Œç»è¿‡ä¸€ç³»åˆ—å¤æ‚çš„è¿‡ç¨‹ï¼Œæœ€åå‘ˆç°å‡ºæ¥

```html

<!-- 1.è§†å›¾å®¹å™¨ -->

<!-- WXMLä¸­æ²¡æœ‰ divï¼Œviewå°±ç›¸å½“äºHTMLä¸­çš„div -->
<view></view>


<!-- 2.åŸºç¡€å†…å®¹ -->


<!-- 3.è¡¨å•ç»„ä»¶ -->

<!-- 4.å¯¼èˆª -->

<!-- 5.-->

```

---

### 2.ç»„ä»¶å…±åŒå±æ€§

- id ç»„ä»¶æ ‡è¯†ï¼Œé¡µé¢å”¯ä¸€
- class ç±»å
- style å†…è”æ ·å¼
- hidden æ˜¯å¦éšè—
- data-* è‡ªå®šä¹‰å±æ€§
- bind*/catch* ç»‘å®šäº‹ä»¶

[æ›´å¤š...å¾®ä¿¡ç»„ä»¶å®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/component/)

---

### 3.WXMLæ•°æ®ç»‘å®š

**ç±»ä¼¼äºVueçš„ {{}}**

```html
<!-- index.wxml é¡µé¢ï¼ˆä¸æ˜¯ç»„ä»¶å“¦ï¼‰ -->
<block>

  <!-- åŸºç¡€ç»‘å®š -->
  <text>{{name}}</text>
  <text class="{{className}}"></text>

  <!-- åŸºç¡€è¿ç®— -->
  <text>{{ name === 'æœ±æ˜†é¹' ?  'ä¸‰ç›®è¿ç®—æµ‹è¯•æˆåŠŸ' : 'ä¸‰ç›®è¿ç®—æµ‹è¯•å¤±è´¥'}}</text>
  <text>{{ name + 'ï¼Œä½ å¥½'}}</text>

  <!-- wx:if -->
  <view wx:if="{{ name === 'æœ±æ˜†é¹' }}">
    <text>åç§°æ˜¯ æœ±æ˜†é¹</text>
  </view>
  <view wx:elif=" name === 'è·¯äººç”²' ">
    <text>åç§°æ˜¯ è·¯äººç”²</text>
  </view>
  <view wx:else>
    <text>åç§°æ˜¯ å…¶ä»–äºº</text>
  </view>

  <!-- wx:for, ä¸‹é¢é‚£ä¸ªblockç»„ä»¶ å°±æ˜¯ä¸ºäº†forå¾ªç¯é˜²æ­¢åˆ›å»ºæ²¡ç”¨çš„ç»„ä»¶ -->
  <block wx:for="{{ [1,2,3] }}"
        wx:for-index="index"
        wx:for-item="item"
        wx:key="index">
    {{index}} {{item}}
  </block>

</view>
```

```js
// index.js é¡µé¢çš„JSï¼ˆä¸æ˜¯ç»„å»ºçš„å“¦ï¼‰

Page({

  // {{}} é‡Œé¢è§£æçš„å°±æ˜¯dataé‡Œé¢çš„ï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰åƒVueä¸€æ ·è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä¼°è®¡æœ‰è‡ªå·±çš„å¤„ç†æ–¹å¼
  data: {
    name: 'æœ±æ˜†é¹',
    className: 'test'
  }

})
```

---

### 4.wx:if å’Œ hiddenå±æ€§çš„å·®å¼‚

- wx:if çš„æ¸²æŸ“æ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰å€¼æ˜¯ true çš„æ—¶å€™ï¼Œå¾®ä¿¡å¼•æ“æ‰ä¼šå¯¹é‡Œé¢çš„å†…å®¹è¿›è¡Œæ¸²æŸ“
  - æ¸²æŸ“è¿‡ç¨‹ï¼šåˆ‡æ¢ false å’Œ true çš„æ—¶å€™ï¼Œéƒ½ä¼šé‡æ–°æ¸²æŸ“
  - é€‚åˆæ¯”è¾ƒç¨³å®šï¼Œä¸é¢‘ç¹åˆ‡æ¢çš„åœºæ™¯
- hiddenå±æ€§ï¼Œä¸ç®¡æ˜¯ falseè¿˜æ˜¯ trueï¼Œç¬¬ä¸€æ¬¡çš„æ—¶å€™éƒ½ä¼šè¢«å¼•æ“åŠ è½½ï¼Œå­˜åœ¨æˆ‘ä»¬çš„é¡µé¢ä¸­
  - æ¸²æŸ“è¿‡ç¨‹ï¼šç”±å§‹è‡³ç»ˆåªå¯¹ç»„ä»¶æ¸²æŸ“ä¸€æ¬¡ï¼Œå³ä½¿åˆ‡æ¢éšè—å’Œæ˜¾ç¤ºï¼Œç»„ä»¶å…¶å®ä¸ä¼šé”€æ¯å’Œåˆ›å»º
  - hiddenåˆå§‹åŒ–æ¶ˆè€—èµ„æºå¤šï¼Œé€‚åˆé¢‘ç¹åˆ‡æ¢çš„åœºæ™¯

---

### 5.å¾®ä¿¡å°ç¨‹åº äº‹ä»¶ç³»ç»Ÿ

- **æ³¨æ„ï¼šå°ç¨‹åºçš„äº‹ä»¶ç³»ç»Ÿï¼Œå¯ä»¥è®¾ç½®æ˜¯å†’æ³¡ï¼Œè¿˜æ˜¯æ•è·**
  - å†’æ³¡ï¼šbindï¼Œä¾‹å¦‚ bind:tapï¼ˆæˆ–è€… bindtapï¼‰
  - æ•è·ï¼šcaptureï¼Œä¾‹å¦‚ capture:tapï¼ˆæˆ–è€…capturetapï¼‰


```html
<!-- index.wxml é¡µé¢ -->
<button data-name="æœ±æ˜†é¹" 222="clickFun">æŒ‰é’®<button>

```

```js

// index.js é¡µé¢çš„JS

Page({

  data: {

  },

  onLoad: function () {

  },

  clickFun: function (e) {
    // äº‹ä»¶å¯¹è±¡ï¼Œå¸¸ç”¨çš„å±æ€§
    
    // e.target ç”¨æˆ·è§¦å‘çš„ç»„ä»¶
    // e.target.dataset ç»„ä»¶ä¸Šç»‘å®šçš„è‡ªå®šä¹‰æ•°æ® | ä¾‹å¦‚ e.target.dataset { name: æœ±æ˜†é¹ }

    // e.currentTarget ç»è¿‡å†’æ³¡ å“åº”çš„ç»„ä»¶
    // e.currentTarget.dataset å’Œä¸Šé¢çš„ä¸€æ ·

  }

})

```

- **å¸¸ç”¨äº‹ä»¶åˆ†ç±»**
  - tap æ‰‹æŒ‡è§¦æ‘¸åé©¬ä¸Šç¦»å¼€ï¼ˆå°±æ˜¯ç‚¹å‡»ï¼‰
  - touchstart æ‰‹æŒ‡è§¦æ‘¸åŠ¨ä½œå¼€å§‹ï¼ˆå°±æ˜¯ç‚¹å‡»å¼€å§‹ï¼‰
  - touchend æ‰‹æŒ‡è§¦æ‘¸åŠ¨ä½œç»“æŸï¼ˆå°±æ˜¯ç‚¹å‡»ç»“æŸï¼‰
  - touchmove æ‰‹æŒ‡è§¦æ‘¸åç§»åŠ¨ï¼ˆå°±æ˜¯æ‹–æ‹½ï¼‰
  - [æ›´å¤šè¯·çœ‹...å®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html)
---


---

### 6.WXS

**ä¸ºä»€ä¹ˆè¦æœ‰WXS**

- å°ç¨‹åºåˆšå¼€å§‹å†…æµ‹çš„æ—¶å€™æ˜¯æ²¡æœ‰WXSï¼Œåæ¥äººä»¬åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼˜åŠ¿äº’ï¼Œæ•°æ®å’Œå±•ç¤ºæ•ˆæœä¹‹é—´ï¼Œå¯èƒ½è¦ç»è¿‡ä¸€äº›æ¯”è¾ƒå¤æ‚çš„é€»è¾‘å¤„ç†
  - ä¾‹å¦‚ï¼šæ•°æ®æ˜¯ 1566739136513 ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå±•ç¤ºå±‚è¦çš„æ•ˆæœæ˜¯ 2019-8-25 21ç‚¹19åˆ†ï¼Œè¿™ç§çš„ï¼Œå°ç¨‹åºåŸæœ‰çš„ {{}} å†™å¾ˆå¤šé€»è¾‘ä¹Ÿä¸å¥½ï¼Œæ‰€ä»¥å°±æœ‰äº†WXSçš„å‡ºç°
  - å¤‡æ³¨ï¼šè¿™ä¸ªè§£å†³çš„é—®é¢˜ï¼Œå°±ç›¸å½“äº Vue ä¸­çš„è®¡ç®—å±æ€§

---

**WXSçš„ä½¿ç”¨ï¼ˆä¸»è¦æœ‰ä¸‰ç§,æ­¤å¤„çš„ä½¿ç”¨ï¼Œè¿˜éœ€è¦ä¸¾ä¾‹ï¼‰**

```js

// 1.å†™åˆ°WXMLé¡µé¢ä¸­


// 2.å†™æˆç‹¬ç«‹çš„WXMLæ–‡ä»¶


// 3.å†™æˆWXSæ–‡ä»¶

// srcå±æ€§å¼•ç”¨
<wxs src="WXSæ–‡ä»¶ç›¸å¯¹è·¯å¾„" module="åç§°"></wxs>

// requireå‡½æ•°å¼•ç”¨
<wxs module="åç§°">
  let åç§° = reuquire('WXSæ–‡ä»¶ç›¸å¯¹è·¯å¾„')
  module.export.data = åç§°.data
</wxs>

```

---


### 4.WXMLå®ç°åŸç†è§£æ



---

## ğŸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šWXSS

--

## ğŸŸç¬¬å››éƒ¨åˆ†ï¼šå¾®ä¿¡å°ç¨‹åºåŸºç¡€ç»„ä»¶

---

## ğŸŒç¬¬äº”éƒ¨åˆ†ï¼šå¾®ä¿¡å°ç¨‹åºAPI

---

## ğŸ¦€ç¬¬å…­éƒ¨åˆ†ï¼šäº‘æœåŠ¡

---

## ğŸ¦‹ç¬¬ä¸ƒéƒ¨åˆ†ï¼šç»„ä»¶åŒ–å¼€å‘å°ç¨‹åº


## ä¹‹å‰çš„å†…å®¹ï¼Œç­‰å¾…é‡æ„

### ä¸€.å°ç¨‹åºçš„åŸºç¡€çŸ¥è¯†ä¸æ–°ç‰¹æ€§

---

### 1.å°ç¨‹åºçš„4ç§æ–‡ä»¶ç±»å‹

- .wxmlï¼šéª¨æ¶
- .wxssï¼šæ ·å¼
- .jsï¼šä¸šåŠ¡é€»è¾‘
- .jsonï¼šé…ç½®

---

### 2.å°ç¨‹åºçš„ç»„ç»‡ç»“æ„

<img src="https://itzkp-1253302184.cos.ap-beijing.myqcloud.com/notes/2.notes/6.%E7%A7%BB%E5%8A%A8%E7%AB%AF/%E5%B0%8F%E7%A8%8B%E5%BA%8F/1.%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84-1.png" />


---

### 3. app.jsoné…ç½®ä¹‹å¯¼èˆªæ 


```
```

---

### 4.wxmlä¸ç»„ä»¶

- å°ç¨‹åºæ¯•ç«Ÿæ˜¯å¾®ä¿¡çš„ä¸€ä¸ªç”Ÿæ€å†…å®¹ï¼Œæ‰€ä»¥åªèƒ½ç”¨å®ƒæ‰€æä¾›çš„ç»„ä»¶ï¼Œæ¥æ­å»ºå†…å®¹ï¼Œè€Œä¸èƒ½ä½¿ç”¨ä¼ ç»Ÿçš„HTMLï¼Œä½†æ˜¯å¤§è‡´çš„ä½¿ç”¨åŸºæœ¬ä¸€è‡´ï¼Œå°±æ˜¯åˆ‡è®°è¿™é‡Œä¸æ˜¯HTMLæ ‡ç­¾ï¼Œè€Œæ˜¯ç»„ä»¶ï¼ŒåæœŸæˆ‘ä»¬ä¹Ÿèƒ½é€šè¿‡è¿™ä¸ªæ¥æ‹¼æ¥è‡ªå·±çš„ç»„ä»¶

---

### äºŒ.åˆè¯†å°ç¨‹åºç»„ä»¶

---

### 1.åˆ¶ä½œä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶

**å®šä¹‰ç»„ä»¶ï¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹components ç”¨æ¥æ”¾ç»„ä»¶ï¼Œç„¶åå»ºç«‹ä¸€ä¸ª like æ–‡ä»¶å¤¹ï¼Œç„¶åä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¿«é€Ÿç”Ÿæˆç›®å½•**

**å¼•ç”¨ç»„ä»¶ï¼šåœ¨éœ€è¦å¼•å…¥çš„é¡µé¢çš„ .jsonæ–‡ä»¶ä¸­è®¾ç½®åç§°**

```json
{
  "usingComponents": {
    "z-like": "/components/like/index"
  }
}
```

**ä½¿ç”¨ç»„ä»¶**

```html
<z-like></z-like>
<z-like></z-like>
<z-like></z-like>
```

---

**â£ï¸ ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„**

```js
// /xxx è¡¨ç¤ºç»å¯¹è·¯å¾„ï¼Œä»æ ¹ç›®å½•å¼€å§‹
// ../xxx è¿™ç§æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œè¿™ä¸ªæ‡‚

```

---

### 2.likeç»„ä»¶æ ·å¼ä¹¦å†™


**å°ç¨‹åºå°ºå¯¸å•ä½å’Œè®¾è®¡åŸåˆ™ï¼šrpx å¯ä»¥è‡ªé€‚åº”ï¼Œpxä¹Ÿæœ‰ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯**

**å°ç¨‹åºçš„CSSé€‰æ‹©å™¨æ¯”æ–‡å½“ä¸­çš„å¤š**

**ğŸ”¥ç»™æ‰€æœ‰é¡µé¢éƒ½è®¾ç½®æ ·å¼ï¼ˆç›¸å½“äºè®¾ç½®å…¨å±€æ ·å¼ï¼‰**

```css
page {
  /* è‹¹æœå¹³æ–¹å­—ä½“ï¼Œç»†ä½“ï¼ŒIOSé»˜è®¤å­—ä½“ï¼Œå®‰å“é»˜è®¤æ˜¯æ€æºå­—ä½“ */
  font-family: "PingFangSC-Thin";
}

/* â£ï¸ï¼šåªæœ‰å°‘é‡å¯ä»¥è¿™æ ·è®¾ç½®ï¼Œç”Ÿæ•ˆçš„åªæœ‰ font color */
```

**æ ·å¼ä¹¦å†™**

```html
<view class="container">
  <image src="./images/like.png"></image>
  <text>9</text>
</view>
```

```css
.container {
  /* è®¾ç½®äº†flexï¼Œé‚£ä¹ˆå­å…ƒç´ æ˜¯å…·æœ‰å—çº§ç‰¹æ€§çš„ï¼Œæ‰€ä»¥ç”¨ inline-flex è¿™æ ·å°±å…·æœ‰è¡Œå†…å—çš„ç‰¹æ€§äº†ï¼Œå­å…ƒç´ ä¹Ÿå°±å®½åº¦è‡ªé€‚åº”äº† */
  display: inline-flex;
  flex-direction: row;
  padding: 10rpx;
}

.container image{
  width: 32rpx;
  height: 28rpx;
}

.container text {
  font-size: 24rpx;
  /* ç»„ä»¶æœ€å¥½ä¸è¦æœ‰ç©ºç™½é—´è· */
  line-height: 24rpx;
  color: #bbb;
  position: relative;
  bottom: 10rpx;
  left: 6rpx;
}
```


---

### 3.ç»„ä»¶çš„æ•°æ®ï¼Œäº‹ä»¶ï¼Œä¸å±æ€§

**æ•°æ®ç»‘å®šï¼šå’Œæ’å€¼è¡¨è¾¾å¼åŸºæœ¬ä¸€è‡´,æ˜¯å†™åˆ°jsæ–‡ä»¶ä¸­çš„ dataå±æ€§é‡Œé¢çš„**

- åŒæ ·å¯ä»¥åº”ç”¨åœ¨æ ‡ç­¾çš„å±æ€§ä¸­ï¼Œè€Œä¸”ä¸ç”¨åƒ Vue ä¸€æ ·åŠ ä¸Š : ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ è®¡ç®—å±æ€§çš„å†™æ³•ï¼Œå¦‚ä¸‹

```html
<view bindtap="onLike" class="container">
  <image src="{{like?yesSrc:noSrc}}"></image>
  <text>{{ count }}</text>
</view>

```

---

**ç»„ä»¶çš„propertieså±æ€§**

- ä¾‹å¦‚ like ç»„ä»¶çš„ç‚¹èµæ•°é‡ï¼Œå’Œ ç‚¹èµçš„çŠ¶æ€ æ˜¯å¼€æ”¾å‡ºæ¥çš„ï¼Œå¯ä»¥è®¾ç½®çš„ï¼Œè¿™ä¸ªå°±éœ€è¦ç”¨åˆ° properties æ¥è®¾ç½®

```js
Component({
  /**
   * ç»„ä»¶çš„å±æ€§åˆ—è¡¨
   */
  properties: {
    like: {
      type: Boolean // é»˜è®¤å€¼æ˜¯false,æ‰€ä»¥ä¸ç”¨å†™é»˜è®¤å€¼
      // value: false
    },
    count: {
      type: Number // é»˜è®¤å€¼æ˜¯0
    }
  }

  // ...
})

// â£ï¸ å±æ€§é‡Œé¢çš„å†…å®¹ï¼Œä¹Ÿèƒ½è¢«æ’å€¼è¡¨è¾¾å¼è¯»å–åˆ°ï¼Œå³ä½¿ data ä¸­æ²¡æœ‰è®¾ç½®
```

---

```js
Component({
  /**
   * ç»„ä»¶çš„æ–¹æ³•åˆ—è¡¨
   */
  methods: {

    // ç‚¹èµäº‹ä»¶
    onLike: function (e) {

      let like = this.properties.like
      let count = this.properties.count

      like = !like
      like ? count+=1 : count-=1

      // è¿™é‡Œå°±ä¸ä¸€æ ·äº†ï¼Œä¸æ˜¯åŒå‘æ•°æ®ç»‘å®šï¼Œéœ€è¦æ‰‹åŠ¨çš„é€šè¿‡ setData æ¥æ”¹å˜
      this.setData({
        like,
        count
      })

    }

  }
  // ...
})
```

---

### ä¸‰.è®¿é—®APIæ•°æ®ä¸ES6åœ¨å°ç¨‹åºä¸­çš„åº”ç”¨

### 1.ç”Ÿå‘½å‘¨æœŸå‡½æ•°

- æˆ‘ä»¬ä¸€èˆ¬åœ¨ onLoad ç”Ÿå‘½å‘¨æœŸä¸­æ‹¿å–æ•°æ®ï¼Œæœ‰ç‚¹åƒ Vueçš„ mounted

---

### 2.wx.request

```js
  /**
   * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
   */
  onLoad: function (options) {

    // è·å–æœ€æ–°ä¸€æœŸçš„æœŸåˆŠ
    wx.request({
      url: 'http://bl.7yue.pro/v1/classic/latest?appkey=EOYWLaUkKhvCc5Le',
      success: function (res) {
        console.log(res)
      }
    })

  },

```

---

**å°è£…ï¼ˆutils/http.jsï¼‰**

```js
// æç¤ºä¿¡æ¯
const tips = {
 1005: 'ç§˜é’¥ä¸æ­£ç¡®ï¼Œè¯·ç°ç”³è¯·',
 1007: 'è®¿é—®çš„åœ°å€ä¸å­˜åœ¨',
 3000: 'æœŸåˆŠä¸å­˜åœ¨'
}

const _showError = code => {
  return tips[code] || 'å…¶ä»–é»˜è®¤é”™è¯¯'
}

export const zhuRequest = params => {

  return new Promise( (resovle, reject) => {

    wx.request({
      url: `http://bl.7yue.pro/v1${params.url}?appkey=EOYWLaUkKhvCc5Le`,
      method: params.method || 'GET',
      
      success(res) {

        let code = res.statusCode.toString()
        
        if (code.startsWith('2')) {
          resovle(res)
        } else {
          wx.showToast({
            title: _showError(res.data.error_code),
            icon: 'none'
          })
          reject(res)
        }

      },

      fail(rej) {
        reject(rej)
      }

    })

  })

}

```

---

**æŠ½ç¦»å‡ºapiå±‚ï¼ˆ/api/classic.jsï¼‰**

```js
import { zhuRequest } from '../utils/http.js'

// è·å–æœ€æ–°æœŸåˆŠ
export const getNews = () => {
  return zhuRequest({
    url: '/classic/latest'
  })
}
```

---

**ä½¿ç”¨**


```js
import { getNews } from '../../api/classic.js'

Page({
  /**
   * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
   */
  onLoad: async function (options) {
    
    // è·å–æ‰€æœ‰æœŸåˆŠæ•°æ®
    let resData = await getNews()
    console.log('æ•°æ®ï¼š', resData)

  }

})

```

---

### 3.ç»„ä»¶å±æ€§èµ‹å€¼ä¸é¡µé¢æ¸²æŸ“

```js
import { getNews } from '../../api/classic.js'

Page({
  /**
   * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
   */
  onLoad: async function (options) {
    
    // è·å–æ‰€æœ‰æœŸåˆŠæ•°æ®
    let resData = await getNews()

    this.setData({
      classicData: resData.data
    })
  
  }

})
```

```html
<!-- ä½¿ç”¨ -->
<z-like count="{{classicData.fav_nums}}" like="{{classicData.like_status}}"></z-like>
```

**â£ï¸ åªèƒ½é€šè¿‡ setDataè¿›è¡Œæ›´æ–°**

---

### ğŸ”¥4.è‡ªå®šä¹‰äº‹ä»¶çš„æ¿€æ´»å’Œç›‘å¬ï¼ˆçˆ¶ç»„ä»¶ç›‘å¬å­ç»„ä»¶äº‹ä»¶ï¼‰

```js
// like å­ç»„ä»¶
Component({

  /**
   * ç»„ä»¶çš„æ–¹æ³•åˆ—è¡¨
   */
  methods: {

    // å­ç»„ä»¶ç‚¹èµäº‹ä»¶
    onLike: function (e) {

      let like = !this.properties.like
      let count = like ? this.properties.count += 1 : this.properties.count -= 1
      this.setData({like, count})

      // å“åº”åˆ°çˆ¶ç»„ä»¶ä¸Šçš„ è‡ªå®šä¹‰äº‹ä»¶
      let behavior = !this.properties.like ? 'like' : 'cancel'
      this.triggerEvent('like', {
        behavior: behavior
      }, {})

    }

  }
})

```

```js
// classic.wxml ä½¿ç”¨
<z-like bind:like="onLike" count="{{classicData.fav_nums}}" like="{{classicData.like_status}}"></z-like>

Page({

  onLike: async function (e) {
    console.log('ç»„ä»¶çš„äº‹ä»¶', e)

    let behavior = e.detail.behavior
    let data = await like(behavior, this.data.classicData.id, this.data.classicData.type)

    console.log('æ•°æ®ï¼š', data)

  },

  // ......
})
```

---

### 5.ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°

- ç»„ä»¶çš„å£°æ˜å‘¨æœŸï¼Œå’Œé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸¤å›äº‹ï¼Œè¿™ä¸ªæ²¡æ¯›ç—…ï¼Œåˆ«æ•´æ··äº†å°±è¡Œï¼Œè¿™å—é‡åˆ°ä¸å¸¸ç”¨çš„æŸ¥ä¸‹æ–‡æ¡£

---

### 6.observerå‡½æ•°çš„åº”ç”¨

**â£ï¸â£ï¸â£ï¸ åƒä¸‡ä¸è¦åœ¨observerå†…éƒ¨æ›´æ”¹è‡ªå·±å±æ€§çš„å€¼ï¼Œä¼šå¯¼è‡´æ— é™é€’å½’è°ƒç”¨**

```js
Component({
  /**
   * ç»„ä»¶çš„å±æ€§åˆ—è¡¨
   */
  properties: {
    index: {
      type: Number,
      observer: function (newVal, oldVal) {
        let val = newVal < 10 ? `0${newVal}` : ''
        this.setData({
          _index: val // â£ï¸ ä¸€ç§å¥—è·¯ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹æœ€å¥½çš„è§£å†³æ–¹æ³•æ˜¯ wxs
        })
      }
    }
  },

  /**
   * ç»„ä»¶çš„åˆå§‹æ•°æ®
   */
  data: {
    year: 0,
    month: '',
    _index: ''
  },

  // ......
})
```

---

### å››.behavioè¡Œä¸ºä¸åŠ å…¥ç¼“å­˜ç³»ç»Ÿ

### 1.behavioè¡Œä¸ºï¼ˆå°ç¨‹åºç»„ä»¶çš„ç»§æ‰¿ï¼‰

```js
// å®šä¹‰
const classicBeh = Behavior({
    properties: {
        img: String,
        content: String,
        hidden:Boolean
    },
    attached:function(){

    },
    data:{

    },
    methods:{

    }
})

export {classicBeh}

```

```js
// ä½¿ç”¨ğŸ”¥

import { classicBeh } from '../classic-beh.js'

Component({

  // ç»§æ‰¿
  behaviors: [classicBeh],

  /**
   * ç»„ä»¶çš„å±æ€§åˆ—è¡¨
   */
  properties: {
  },

  // ......
})
```


---

### 2.behavior ç»§æ‰¿ä¸å¤šç»§æ‰¿çš„è¦†ç›–è§„åˆ™

```js
// è¿™ç§å†™æ³•ï¼Œè¡¨ç¤ºæ˜¯æ”¯æŒå¤šç»§æ‰¿çš„
behaviors: [classicBeh, beh1, ...]

// æ—¢ç„¶æ”¯æŒå¤šç»§æ‰¿ï¼Œå°±æœ‰ä¸€ä¸ªè¦†ç›–è§„åˆ™ï¼š
// å­ç»„ä»¶ä¸­ä¼šè¦†ç›–ç»§æ‰¿çš„ï¼ˆè‡ªç»„ä»¶ä¸­çš„æƒçº§é«˜
// ç»§æ‰¿çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä¸ä¼šè¦†ç›–
```


---

### 3.å°ç¨‹åºçš„ç¼“å­˜ç³»ç»Ÿ

```js
// å†™å…¥ç¼“å­˜
wx.setStorageSync('keyåç§°', å˜é‡) // å¼‚æ­¥å†™å…¥
wx.setStorage('keyåç§°', å˜é‡) // åŒæ­¥å†™å…¥

// è¯»å–ç¼“å­˜
wx.getStorageSync('keyåç§°') // å¼‚æ­¥å»è¯»
wx.getStorage('keyåç§°') // åŒæ­¥å»è¯»
```

---

### äº”.æ–°ç‰ˆMusicç»„ä»¶ï¼Œç»„ä»¶é€šä¿¡ï¼ŒWXSSæ ·å¼å¤ç”¨

### 1.å¦‚ä½•è®©è‡ªå®šä¹‰ç»„ä»¶æ”¯æŒhidden

- wx:if çš„æ–¹å¼å¯ä»¥éšè—ç»„ä»¶ï¼Œä½†æ˜¯ hidden å´éšè—ä¸äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œè¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆï¼Ÿ
- åŸå› æ˜¯å°ç¨‹åºä¼šè®¤ä¸ºè¿™ä¸ªå¯èƒ½æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„å±æ€§
- è§£å†³æ–¹æ³•ï¼šåœ¨ç»„ä»¶ä¸­è®¾ç½® hidden å±æ€§ï¼Œç„¶åç›´æ¥è®¾ç½®
- ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿™é‡Œè¦ç”¨ hiddenï¼Œå› ä¸ºå¦‚æœè¦é¢‘ç¹çš„åˆ‡æ¢ï¼Œç”¨ hidden æ¯”è¾ƒå¥½ï¼ˆå…·ä½“å¯ä»¥çœ‹ wx:if vs hiddenï¼‰

---

### 2.@importåœ¨ç»„ä»¶ä¸­å¤ç”¨æ ·å¼

- ç›´æ¥å®šä¹‰ä¸€ä»½ .wxss æ–‡ä»¶ï¼ˆä¾‹å¦‚ common.wxssï¼‰

```css
/* åœ¨éœ€è¦çš„wxssæ–‡ä»¶ä¸­ å¼•ç”¨ */
@import '../common.wxss';
```

---

### 3.ç»„ä»¶é—´çš„é€šä¿¡

- ä¸»è¦è§£å†³ï¼ŒéŸ³ä¹æ’­æ”¾ç»„ä»¶ï¼Œä¸€ä¸ªæ’­æ”¾å…¶ä»–çš„æš‚åœï¼Œå¹¶ä¸”ç›¸äº’ç‹¬ç«‹ä¸å½±å“ï¼Œçˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ¯”è¾ƒå¥½è§£å†³ï¼Œä½†æ˜¯å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„é€šä¿¡é—®é¢˜æ€ä¹ˆè§£å†³å‘¢
- æ–¹æ¡ˆä¸€ï¼šå­ç»„ä»¶å…ˆæŠŠæ•°æ®å‘ç»™ çˆ¶ç»„ä»¶ ï¼Œç„¶åçˆ¶ç»„ä»¶å†å‘ç»™ ç›®æ ‡å­ç»„ä»¶ï¼Œè¿™æ ·å®ç°å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„é€šä¿¡é—®é¢˜
- æ–¹æ¡ˆäºŒï¼šç»„ä»¶æ¶ˆå¤±çš„æ—¶å€™ï¼Œæš‚åœéŸ³ä¹


---

### 4. wx:for && wx:key

```js
// itemè¡¨ç¤ºæ¯ä¸€é¡¹ï¼ˆä¹Ÿå¯ä»¥è‡ªå®šä¹‰å€¼ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸éœ€è¦ï¼‰
// æ³¨æ„è¿™é‡Œå†™çš„æ˜¯ id è€Œä¸æ˜¯ {{item.id}}
<block wx:key="id" wx:for="{{books}}">
  <z-book book="{{item}}"></z-book>
</block>
```

---

### 5.ç»„ä»¶å‘é¡µé¢ä¼ é€’æ•°æ®

```js
// ç»„ä»¶ä¸­ä¼ é€’
Component({
  /**
   * ç»„ä»¶çš„æ–¹æ³•åˆ—è¡¨
   */
  methods: {
    onTap: function (e) {
      const bid = this.properties.book.id
      wx.navigateTo({
        url: `/pages/book-detail/index?bid=${bid}`,
      })
    }
  }
  // ...
})


// ä½¿ç”¨
Page({
  /**
   * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
   */
  onLoad: function (options) {
    console.log('options', options) // {bid: xxx}
  },

  // ...
})
```

---

### 6.ç»„ä»¶è®¾è®¡æ€æƒ³ï¼šslotæ’æ§½çš„ä½¿ç”¨

```js
// å®šä¹‰æ’æ§½ .wxml
<view class="container">
  <text>{{text}}</text>
  <!-- slotæ’æ§½ -->
  <slot name="after"></slot>
</view>

// å¯åŠ¨æ’æ§½ .js
Component({

  // å¯åŠ¨æ’æ§½
  options: {
    multipleSlots: true
  },

  // ...
})

// ğŸ”¥ä½¿ç”¨æ’æ§½
<z-tag text="{{item.content}}">
  <text class="num" slot="after">{{'+' + item.nums}}</text>
</z-tag>
```

---

### 7.è‡ªå®šä¹‰ç»„ä»¶æ ·å¼æ¢è®¨ï¼šhackæ–¹å¼ && å¤–éƒ¨æ ·å¼çš„æ¦‚å¿µ

- æˆ‘ä»¬æ²¡åŠæ³•ç›´æ¥å¯¹è‡ªå®šä¹‰ç»„ä»¶è¿›è¡Œæ ·å¼ä¸Šçš„è®¾ç½®ï¼Œå¦‚æœæˆ‘ä»¬äº†è§£æˆ‘ä»¬å†™çš„ç»„ä»¶çš„å†…éƒ¨ï¼Œé‚£ä¹ˆå°±èƒ½ç”¨ä¸‹é¢çš„æ–¹å¼æ¥è¿›è¡Œï¼Œæœ‰ç§hackçš„æ„Ÿè§‰

```css
.comment-container>v-tag:nth-child(1)>view {
    background-color: #fffbdd;
}

.comment-container>v-tag:nth-child(2)>view {
    background-color: #eefbff;
}
```

---

**ğŸ”¥å¤–éƒ¨æ ·å¼**

- JSä¼ å€¼ï¼Œå¯ä»¥é€šè¿‡
- wxmlä¼ é€’ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ slot å®ç°
- CSSä¼ å€¼é€šè¿‡ï¼Ÿå¤–éƒ¨æ ·å¼ externalClasses: []

```js
// å®šä¹‰å¤–éƒ¨æ ·å¼
Component({

  // å¯åŠ¨æ’æ§½
  options: {
    multipleSlots: true
  },

  // å®šä¹‰å¤–éƒ¨æ ·å¼
  externalClasses: ['tag-class'],

  // ...
})

// å®šä¹‰
<view class="tag-class">
  <slot name="after"></slot>
</view>


// ä½¿ç”¨ï¼ˆè¿™é‡Œä½ å‘ç°ï¼Œå› ä¸ºæ²¡æœ‰è®¡ç®—å±æ€§ï¼Œæ‰€ä»¥éœ€è¦äº›å¾ˆé•¿ä¸€æ®µï¼Œä¸‹é¢å¯ä»¥é€šè¿‡wxsæ¥è¿›è¡Œä¼˜åŒ–ï¼‰
<z-tag tag-class="{{index===0?'ex-tag1': '' || index===1?'ex-tag2':''}}" text="{{item.content}}">
</z-tag>

```

---

### å…­.å°ç¨‹åºwxsçš„åº”ç”¨

### 1.wxsçš„æ¦‚å¿µä¸åº”ç”¨ï¼ˆåœ¨æˆ‘çœ‹æ¥æœ‰äº›ç¹çï¼Œæ²¡æœ‰è®¡ç®—å±æ€§å¥½ç”¨ï¼‰

- æˆ‘ä»¬ä¹‹å‰æƒ³åœ¨ wxml ç¼–å†™jsæˆ–è€…è°ƒç”¨jsæ˜¯ä¸å¯èƒ½çš„ï¼Œåæ¥åˆäº† wxsï¼Œæœ‰äº†è¿™ä¸ªå°±è¡Œäº†ï¼ˆæœ‰ç‚¹åƒVueçš„è®¡ç®—å±æ€§ï¼‰

```js
// å®šä¹‰ï¼ˆæ³¨æ„ WXS ä¸æ˜¯ JavaScriptï¼Œè¯­æ³•å’Œ ES3ç±»ä¼¼ï¼Œlet const éƒ½ä¸èƒ½ç”¨ï¼‰
var format =  function (text) {

  if (!text) {
    return
  }

  var reg = getRegExp('\\\\n', 'g')
  return text.replace(reg, '\n')
}

module.exports = {
  format: format
}

// ä½¿ç”¨ /pages/book-detail/index.wxml
<wxs src="../../utils/filter.wxs" module="util" />

<text class="content">{{util.format(detail.summary)}}</text>
```

---

**ä¹Ÿå¯ä»¥åœ¨ wxml é‡Œé¢ç›´æ¥å†™ wxs**

```html
<wxs module="tool">
    var highlight = function(index){
        if(index==0){
            return 'ex-tag1'
        }
        if(index==1){
            return 'ex-tag2'
        }
        return ''
    }

    module.exports = {
        highlight:highlight
    }
</wxs>
```

---

### 2.å¼€å¯åŠ è½½çŠ¶æ€ï¼ˆï¼‰

```js
Page({
  /**
   * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
   */
  onLoad: async function (options) {
    
    wx.showLoading({
      title: 'ä¹¦ç±è¯¦æƒ…åŠ è½½ä¸­ï¼Œè¯·ç¨ç­‰',
    })

    const bid = options.bid

    // åšæˆå¹¶è¡Œå‘é€æœ€å¥½
    // let resDetail = await getDetail(bid)
    // let resComment = await getComment(bid)
    // let resFavor = await getFavor(bid)

    // å¹¶è¡Œ
    let data = await Promise.all([getDetail(bid), getComment(bid), getFavor(bid)])
    let resDetail = data[0]
    let resComment = data[1]
    let resFavor = data[2]

    this.setData({
      detail: resDetail.data,
      comment: resComment.data,
      likeStatus: resFavor.data.like_status === 1,
      likeCount: resFavor.data.fav_nums
    })

    wx.hideLoading()
  },

  // ......
})
```

---



