# 3.Cliä¹¦å†™

::: warning
æ³¨æ„æ­¤å¤„ï¼šå†…å®¹ä¸å…¨ï¼Œç»“æ„æ··ä¹±ï¼Œç­‰å¾…é‡æ„...
:::

## ç®€å•CLIç¤ºä¾‹ï¼ˆä¸‹è½½è‡ªå·±ä»£ç æ–¹åº“çš„çš„ä¸€ä¸ªCliï¼‰

---

### 1.ä»£ç 

```js
#!/usr/bin/env node

let zkp = `
       _            
 ____ | | __  _ __ 
|_  / | |/ / | '_ \\ 
 / /  |   <  | |_) |
/___| |_|\\_\\ | .__/ 
             |_|   

æœ±æ˜†é¹è„šæ‰‹æ¶ v0.0.1

zkp init ä¸‹è½½Gitä»“åº“
`

const program = require('commander') // æ ¸å¿ƒå‘½ä»¤è¡Œå·¥å…·
const Printer = require('@darkobits/lolcatjs') // å­—ä½“æ¸å˜ï¼ˆç¾è§‚ç”¨ï¼Œæ²¡å•¥å…¶ä»–ç”¨å¤„ï¼ŒèŠ±é‡Œèƒ¡å“¨ï¼‰
const shelljs = require('shelljs'); // å‰ç«¯å†™shell
const userHome = require('user-home') // è·å–ç”¨æˆ·çš„ç›®å½•ï¼Œå¥½è¿›è¡Œåˆ›å»ºæ–‡ä»¶å¤¹çš„æ“ä½œ
const inquirer = require('inquirer') // è·Ÿç”¨æˆ·è¿›è¡Œäº¤äº’
const ora = require('ora') // loadingæ¨¡å—
const download = require('download-git-repo') // ä¸‹è½½Gité¡¹ç›®

// å‘½ä»¤é›†åˆ
let binHeader = {

    init () {
        inquirer
            .prompt([
                {
                    type: 'text',
                    message: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹',
                    name: 'dirname'
                },
                {
                    type: 'list',
                    message: 'è¯·é€‰æ‹©æ‹‰å–çš„æ¨¡æ¿',
                    choices: ['Notes', 'Juejin-Plugin', 'Wheel', 'miniVue', 'Koa-api-template'],
                    name: 'kind'
                }
            ]).then( answers => {

                // console.log(answers) // ç¤ºä¾‹ï¼š{ dirname: 'sss', Kind: 'Notes' }
                let { dirname, kind } = answers

                const spinner = ora('ğŸ˜º åˆå§‹åŒ–æ¨¡æ¿')
                spinner.start()

                let _projectPath = `${userHome}/Desktop/å‘å¸ƒä¸€ä¸ªcli/${dirname}`
                shelljs.cd(_projectPath)
                shelljs.mkdir(dirname)


                let templateStr = `direct:https://github.com/zhukunpenglinyutong/${kind}`
                switch (kind) {
                    case 'Notes': downloadFn(templateStr, _projectPath, spinner); break;
                    case 'Juejin-Plugin': downloadFn(templateStr, _projectPath, spinner); break;
                    case 'Wheel': downloadFn(templateStr, _projectPath, spinner); break;
                    case 'miniVue': downloadFn(templateStr, _projectPath, spinner); break;
                    case 'Koa-api-template': downloadFn(templateStr, _projectPath, spinner); break;
                }                
            })
    }

}

// åŠ è½½å‡½æ•°
function downloadFn(template, _projectPath, spinner) {
    download(template, _projectPath,{ clone: true }, err => {
        spinner.stop()
        if (err) {
            console.error(`ä¸‹è½½å‡ºé”™`, err.message.trim())
        } else {
            console.log('ä¸‹è½½æˆåŠŸ âœ…')
        }
    })
}


program.version(Printer.default.fromString(zkp), "-v, --version")
// program.command("init", "åˆå§‹åŒ–æˆ‘ä»¬çš„é¡¹ç›®") // zkp --help ä¸­ä¼šæœ‰æç¤º

program
    .usage("[cmd] <options>")
    .arguments("<cmd> [env]")
    .action( (cmd, otherParms) => {
        let header = binHeader[cmd]
        typeof header === 'undefined' ? process.exit(1) : header()
    })

program.parse(process.argv)
```

---

### 2.å‘å¸ƒåˆ°npmä¸Šå»

