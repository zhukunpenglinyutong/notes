# 4.MongoDBé€ŸæŸ¥

> å†…å®¹å°šæœªæ¢³ç†

## ä¹‹å‰çš„å†…å®¹ï¼Œé‡æ„å®Œæˆä¹‹ååˆ é™¤

**(mongooseå®˜æ–¹æ–‡æ¡£)[http://mongoosejs.net/]ï¼Œå®‰è£…ä¹‹ç±»çš„ç…§ç€ä¸Šé¢æ¥**

### 1.å¿«é€Ÿä¸Šæ‰‹

```js

// â‘  è¿æ¥æ•°æ®åº“
var mongoose = require('mongoose');
mongoose.connect('mongodb://ipæˆ–è€…ç½‘å€:ç«¯å£å·/æ•°æ®åº“åç§°?é…ç½®...'); // è¿æ¥æ•°æ®åº“ï¼Œé…ç½®å¯ä»¥ä¸å†™

// é”™è¯¯ å’Œ æˆåŠŸ
db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', function() { console.log('è¿æ¥æˆåŠŸ') });


// â‘¡ åˆ›å»º Schema (Mongoose é‡Œï¼Œä¸€åˆ‡éƒ½å§‹äºSchema)
var personSchema = mongoose.Schema({
  name: String,
  age: { type: Number }
});


// â‘¢ æŠŠ schema ç¼–è¯‘æˆä¸€ä¸ª Model
var Person = mongoose.model('Person', personSchema); // æ³¨ï¼š'Person' è¿™ä¸ªæ˜¯ MongoDB è¿æ¥çš„æ•°æ®åº“çš„ é›†åˆåç§°


// â‘£ ä½¿ç”¨ Model
// æ³¨ï¼šmodel æ˜¯æˆ‘ä»¬æ„é€  document çš„ Classï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªé›†åˆé‡Œé¢æœ‰å¾ˆå¤šæ–‡æ¡£

Person.find() // æŸ¥æ‰¾æ‰€æœ‰çš„æ–‡æ¡£
Person.find({ name: /æœ±/ }) // æŸ¥æ‰¾ç‰¹å®šçš„æ–‡æ¡£

var zhu = new Person({ name: 'æœ±æ˜†é¹', age: 21 }) // æ·»åŠ æ–‡æ¡£ï¼Œ.save()æ˜¯mongooseè§„å®šçš„æ·»åŠ æ–‡æ¡£çš„æ–¹æ³•
zhu.save()

```

---

### 2.è¿æ¥ï¼ˆçœç•¥...ï¼‰


---

### 3.æ¨¡å¼ç±»å‹ï¼ˆSchemaTypesï¼‰

åˆæ³•çš„æ¨¡å¼ç±»å‹æœ‰ï¼šStringï¼ŒNumberï¼ŒArrayï¼ŒBooleanï¼ŒObjectIdï¼ŒDateï¼ŒBufferï¼ŒMixedï¼ŒDecimal128

```js

// è¯¦ç»†ç¤ºä¾‹


```

### 4.æ¨¡å‹ï¼ˆModelsï¼‰

```js

// â‘  å¢
var zhu = new Person({ name: 'æœ±æ˜†é¹', age: 21 }) // Documents æ˜¯ model çš„å®ä¾‹ã€‚ åˆ›å»ºå®ƒä»¬å¹¶ä¿å­˜åˆ°æ•°æ®åº“éå¸¸ç®€å•
zhu.save()


// â‘¡ åˆ 
Person.remove({ name: 'æœ±æ˜†é¹' }) // model çš„ remove æ–¹æ³•å¯ä»¥åˆ é™¤æ‰€æœ‰åŒ¹é…æŸ¥è¯¢æ¡ä»¶çš„æ–‡æ¡£ã€‚


// â‘¢ æ”¹
Person.findOneAndUpdate(...) // model çš„ update æ–¹æ³•å¯ä»¥ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ–‡æ¡£ï¼Œä¸è¿‡ä¸ä¼šæŠŠæ–‡æ¡£è¿”å›ç»™åº”ç”¨å±‚ï¼Œå¯ä»¥ä½¿ç”¨ findOneAndUpdate æ–¹æ³•

// â‘£ æŸ¥
Person.find() // æŸ¥æ‰¾æ‰€æœ‰çš„æ–‡æ¡£
Person.find({ name: /æœ±/ }) // æŸ¥æ‰¾ç‰¹å®šçš„æ–‡æ¡£

```

---

### 5.å…¶ä»–





## ğŸ“šå‚è€ƒåˆ—è¡¨ï¼ˆè‡´æ•¬ï¼‰