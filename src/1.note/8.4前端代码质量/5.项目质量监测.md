# 5.项目质量监测

::: danger
注意：此篇文章未来可能要和其他文章进行合并，或者重构... 目前结构混乱，无法阅读
:::

### 简介

**🔥通常来说，项目的质量决定了 软件项目的命运，软件项目的可维护性，软件项目的运维成本，软件项目的拓展性**

**为什么要进行代码检查**

- 避免低级BUG
- 统一代码习惯
- 保证线上代码质量

**如何让一个团队的人产出的代码都在一个基本水平底线之上呢?**

最初是靠制订规范。要确保规范得以执行只能靠人，所以文字规范成了code review的公共参照标准。单纯靠人的事最终都容易流于形式，

🔥所以需要工具加以保证。虽说工具并不能完全实现规范中的规则，但至少能够在一定程度 上缓解代码不统一一的局面


**从哪几个方面可以让项目质量有所提高呢？**

- 代码Lint：告别低级错误，简单的配置让程序来自动检查
- e2e test：e2e测试，黑盒测试，如何用e2e进行端到端的测试
- 开源测试平台：codecov介绍（配合CI工具，让测试过程自动化）

---

### 2.日常写代码中遇到的问题

**代码风格**

**代码规范**

这里使用 Typescript 能提高代码质量

**设计思路**

有的人写的程序就是高度耦合的，几十个函数，很难调用，没办法维护，这就和思路有关系了，要设计一些设计模式，设计一些模块化的东西，来规避这点

---

### 3.代码质量检测 Lint

**Lint：是一款分析源码以及标记编程过程中（代码，样式，构建）书写的错误的工具**

常见的3个JS检测工具对比

- JSLint（2012年出现）：
    - 优点：参数配置完成，可以直接使用
    - 缺点：有限的配置选项，不能增加个性化的规则等等
- JSHint
    - 优点：可配置，可以写配置文件
    - 缺点：难于知道那个规则产生的错误，不能自定义规则等等
- 🔥ESLint（比较新的工具，JSCS已经合并到ESLint）
    - 优点：高度可配置
    - 缺点：需要一些配置，速度慢

---

### 4.Lint工具介绍（4个核心概念）

**核心是配置文件，规则是写到里面的：.eslintrc.js**

**常见规则**

- off && 0：关闭规则
- warn && 1：开启规则，使用警告级别错误（不会导致程序退出）
- error && 2：开启规则，使用错误级别错误（程序会退出）

```js
// 例如
{
    "rules": {
        "semi": ["error", "never"]
    }
}
```

**Extends：使用别人的包（使用别人的规则）**

```js
{
    "extends": "google"
}
```

**🔥Plugins：插件系统**

我们有时候可能有一些特殊的应用场景，例如Vue的语法，例如less，sass等这些的语法，可能 使用别人的包里面也没有这些配置，我们就需要自己配置了（针对特定的语法结构进行Lint）

---

### 5.ESLint初始化

- 安排：npm install eslint --save-dev
- 使用

```js
// 
"scripts": {
  "lint": "eslint app.js",
  "lint:create": "eslint --init",
},
```

**使用 eslint --init创建一个ESLint配置文件**

- 第一个问题：检查代码规范 | 🔥检查代码规范并查找一些问题 | 强制使用某些规范
- 第二个问题（你使用哪种模块方式）：🔥ESM | COM | 不使用
- 第三个问题（选择常见的框架）
- 第四个问题（你的代码会在哪里运行）：🔥浏览器 | 🔥Node
- 第五个问题（你想把这些配置放到什么文件中）

```js
module.exports = {
    "env": { // 运行环境
        "browser": true,
        "es6": true,
        "node": true
    },
    "extends": "eslint:recommended", // 拓展规则
    "globals": { // 执行代码时脚本需要访问额外全局变量
        "Atomics": "readonly",
        "SharedArrayBuffer": "readonly"
    },
    "parserOptions": { // 用于指定想要支持的JS语言
        "ecmaVersion": 2018,
        "sourceType": "module"
    },
    "rules": { // 开启某些规则，设置规则登记
    }
};
```

**❣️注意，有时候也要写另一个文件.eslintignore，用于告诉ESLint忽略某些文件或者目录**


---


