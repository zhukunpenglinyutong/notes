<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.Node绪论 | Notes</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="知识速查（了不起的个人工具库）">
    <link rel="preload" href="/assets/css/0.styles.f5078b10.css" as="style"><link rel="preload" href="/assets/js/app.f2516ed4.js" as="script"><link rel="preload" href="/assets/js/2.b5be6ff6.js" as="script"><link rel="preload" href="/assets/js/73.51b916d0.js" as="script"><link rel="preload" href="/assets/js/3.87d40112.js" as="script"><link rel="prefetch" href="/assets/js/10.35e5e2b7.js"><link rel="prefetch" href="/assets/js/100.e67d24bc.js"><link rel="prefetch" href="/assets/js/101.8805974b.js"><link rel="prefetch" href="/assets/js/102.c5475d9e.js"><link rel="prefetch" href="/assets/js/103.6977e35c.js"><link rel="prefetch" href="/assets/js/104.ed9a180b.js"><link rel="prefetch" href="/assets/js/105.b9e863b3.js"><link rel="prefetch" href="/assets/js/106.2af16856.js"><link rel="prefetch" href="/assets/js/107.31538448.js"><link rel="prefetch" href="/assets/js/108.719b7c9c.js"><link rel="prefetch" href="/assets/js/109.ea679fce.js"><link rel="prefetch" href="/assets/js/11.88a97907.js"><link rel="prefetch" href="/assets/js/110.c81ee9d5.js"><link rel="prefetch" href="/assets/js/111.7f69e65d.js"><link rel="prefetch" href="/assets/js/112.72258ddc.js"><link rel="prefetch" href="/assets/js/12.bf0f2c7b.js"><link rel="prefetch" href="/assets/js/13.b246cedc.js"><link rel="prefetch" href="/assets/js/14.c8298f66.js"><link rel="prefetch" href="/assets/js/15.a80b1d45.js"><link rel="prefetch" href="/assets/js/16.9f8d4d27.js"><link rel="prefetch" href="/assets/js/17.5515190b.js"><link rel="prefetch" href="/assets/js/18.38b3c891.js"><link rel="prefetch" href="/assets/js/19.bae830c1.js"><link rel="prefetch" href="/assets/js/20.bbb98eac.js"><link rel="prefetch" href="/assets/js/21.70845d4e.js"><link rel="prefetch" href="/assets/js/22.6166d260.js"><link rel="prefetch" href="/assets/js/23.3ed55092.js"><link rel="prefetch" href="/assets/js/24.86663ab9.js"><link rel="prefetch" href="/assets/js/25.d873c7a2.js"><link rel="prefetch" href="/assets/js/26.da03dd1a.js"><link rel="prefetch" href="/assets/js/27.0857ab05.js"><link rel="prefetch" href="/assets/js/28.f06dd93c.js"><link rel="prefetch" href="/assets/js/29.e6a51913.js"><link rel="prefetch" href="/assets/js/30.9eddc820.js"><link rel="prefetch" href="/assets/js/31.7b1c958f.js"><link rel="prefetch" href="/assets/js/32.00028b3b.js"><link rel="prefetch" href="/assets/js/33.9925562b.js"><link rel="prefetch" href="/assets/js/34.83ed9b84.js"><link rel="prefetch" href="/assets/js/35.94596f7b.js"><link rel="prefetch" href="/assets/js/36.12266af3.js"><link rel="prefetch" href="/assets/js/37.101b8b9c.js"><link rel="prefetch" href="/assets/js/38.cbd3c52d.js"><link rel="prefetch" href="/assets/js/39.a175711d.js"><link rel="prefetch" href="/assets/js/4.02bf3d71.js"><link rel="prefetch" href="/assets/js/40.8291eb1a.js"><link rel="prefetch" href="/assets/js/41.34907669.js"><link rel="prefetch" href="/assets/js/42.1347b1c2.js"><link rel="prefetch" href="/assets/js/43.c588d6c9.js"><link rel="prefetch" href="/assets/js/44.0b5847af.js"><link rel="prefetch" href="/assets/js/45.55878d65.js"><link rel="prefetch" href="/assets/js/46.0b17e194.js"><link rel="prefetch" href="/assets/js/47.ef1df327.js"><link rel="prefetch" href="/assets/js/48.14215855.js"><link rel="prefetch" href="/assets/js/49.c3a89b55.js"><link rel="prefetch" href="/assets/js/5.d572fee8.js"><link rel="prefetch" href="/assets/js/50.224110e5.js"><link rel="prefetch" href="/assets/js/51.a067aaf7.js"><link rel="prefetch" href="/assets/js/52.e37db22c.js"><link rel="prefetch" href="/assets/js/53.6e95c85c.js"><link rel="prefetch" href="/assets/js/54.844c0d12.js"><link rel="prefetch" href="/assets/js/55.72478f22.js"><link rel="prefetch" href="/assets/js/56.9ffbaa6d.js"><link rel="prefetch" href="/assets/js/57.3b2b96cb.js"><link rel="prefetch" href="/assets/js/58.d01cee9b.js"><link rel="prefetch" href="/assets/js/59.5fb6bca7.js"><link rel="prefetch" href="/assets/js/6.1cd776fd.js"><link rel="prefetch" href="/assets/js/60.498fd1e2.js"><link rel="prefetch" href="/assets/js/61.a402dc0f.js"><link rel="prefetch" href="/assets/js/62.d0065cf8.js"><link rel="prefetch" href="/assets/js/63.e94506ac.js"><link rel="prefetch" href="/assets/js/64.0d8ec08a.js"><link rel="prefetch" href="/assets/js/65.c5be27b4.js"><link rel="prefetch" href="/assets/js/66.e4b0c082.js"><link rel="prefetch" href="/assets/js/67.b2be89ef.js"><link rel="prefetch" href="/assets/js/68.1f6f139e.js"><link rel="prefetch" href="/assets/js/69.ce10c0f3.js"><link rel="prefetch" href="/assets/js/7.01faab87.js"><link rel="prefetch" href="/assets/js/70.33616c52.js"><link rel="prefetch" href="/assets/js/71.0b8d493f.js"><link rel="prefetch" href="/assets/js/72.7666a73f.js"><link rel="prefetch" href="/assets/js/74.62ebdb0f.js"><link rel="prefetch" href="/assets/js/75.d6905641.js"><link rel="prefetch" href="/assets/js/76.d8833735.js"><link rel="prefetch" href="/assets/js/77.85302ac6.js"><link rel="prefetch" href="/assets/js/78.7c05a122.js"><link rel="prefetch" href="/assets/js/79.0eb7a7d6.js"><link rel="prefetch" href="/assets/js/8.6639ecf1.js"><link rel="prefetch" href="/assets/js/80.a4626fd1.js"><link rel="prefetch" href="/assets/js/81.d68b98fd.js"><link rel="prefetch" href="/assets/js/82.8069da06.js"><link rel="prefetch" href="/assets/js/83.85947d20.js"><link rel="prefetch" href="/assets/js/84.1a5f2453.js"><link rel="prefetch" href="/assets/js/85.a7a2253e.js"><link rel="prefetch" href="/assets/js/86.2ea16429.js"><link rel="prefetch" href="/assets/js/87.8ba893a4.js"><link rel="prefetch" href="/assets/js/88.b92c6ebb.js"><link rel="prefetch" href="/assets/js/89.5f2cf8bb.js"><link rel="prefetch" href="/assets/js/9.dac21db2.js"><link rel="prefetch" href="/assets/js/90.1f7e8323.js"><link rel="prefetch" href="/assets/js/91.f7b05486.js"><link rel="prefetch" href="/assets/js/92.b52805fb.js"><link rel="prefetch" href="/assets/js/93.82513672.js"><link rel="prefetch" href="/assets/js/94.6d48faf9.js"><link rel="prefetch" href="/assets/js/95.c15c94ee.js"><link rel="prefetch" href="/assets/js/96.4668611c.js"><link rel="prefetch" href="/assets/js/97.7efd20e5.js"><link rel="prefetch" href="/assets/js/98.67e6aca7.js"><link rel="prefetch" href="/assets/js/99.ec48a5d6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f5078b10.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/1.quickcheck/" class="nav-link">
  速查
</a></div><div class="nav-item"><a href="/2.note/" class="nav-link router-link-active">
  前端体系
</a></div><div class="nav-item"><a href="/3.other/" class="nav-link">
  其他
</a></div> <a href="https://github.com/zhukunpenglinyutong/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/1.quickcheck/" class="nav-link">
  速查
</a></div><div class="nav-item"><a href="/2.note/" class="nav-link router-link-active">
  前端体系
</a></div><div class="nav-item"><a href="/3.other/" class="nav-link">
  其他
</a></div> <a href="https://github.com/zhukunpenglinyutong/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>0.计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1.HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2.CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3.JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>4.jQuery及其周边库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>5.1MVVM框架（Vue）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>5.2MVVM框架（React）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>6.移动端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>7.Node</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2.note/7.Node/1.Node绪论.html" class="active sidebar-link">1.Node绪论</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2.note/7.Node/1.Node绪论.html#🍬第一部分-node发展史" class="sidebar-link">🍬第一部分：Node发展史</a></li><li class="sidebar-sub-header"><a href="/2.note/7.Node/1.Node绪论.html#🍡第二部分-node-io读写模块分享" class="sidebar-link">🍡第二部分：Node（io读写模块分享）</a></li><li class="sidebar-sub-header"><a href="/2.note/7.Node/1.Node绪论.html#🍧第三部分-node-io读写模块实际应用-h5本地化平台" class="sidebar-link">🍧第三部分：Node（io读写模块实际应用-H5本地化平台）</a></li><li class="sidebar-sub-header"><a href="/2.note/7.Node/1.Node绪论.html#🍭第四部分-一些封装好的io读写模块函数分享" class="sidebar-link">🍭第四部分：一些封装好的io读写模块函数分享</a></li></ul></li><li><a href="/2.note/7.Node/2.原生Node.html" class="sidebar-link">2.原生Node</a></li><li><a href="/2.note/7.Node/3.Express框架.html" class="sidebar-link">3.Express框架</a></li><li><a href="/2.note/7.Node/4.Koa2框架.html" class="sidebar-link">4.Koa2框架</a></li><li><a href="/2.note/7.Node/5.Egg框架.html" class="sidebar-link">5.Egg框架</a></li><li><a href="/2.note/7.Node/6.Node技术应用.html" class="sidebar-link">6.Node技术应用</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.0网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.1前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.2 前端安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.3前端性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.4前端代码质量</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.5运维</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.6前端架构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>9.项目</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-node绪论"><a href="#_1-node绪论" class="header-anchor">#</a> 1.Node绪论</h1> <h2 id="🍬第一部分-node发展史"><a href="#🍬第一部分-node发展史" class="header-anchor">#</a> 🍬第一部分：Node发展史</h2> <h3 id="_1-node发展历史"><a href="#_1-node发展历史" class="header-anchor">#</a> 1.Node发展历史</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>前言：能用 JavaScript 编写的程序，都终将会以 JavaScript 编写</p> <p>我以前以为这句话是个玩笑话，但是随著 Node.js 的发展，我们渐渐地明白到这句话的远见性──JavaScript 真的越来越强大了。</p></div> <p>Node.js诞生自 2009 年，但是它确实有史以来发展最快的开发工具，没有之一。</p> <ul><li>2009年3月：node.js 诞生</li> <li>2009年10月：Isaac Schlueter（Node的核心用户）首次提出npm</li> <li>20010年3月：express.js 问世</li> <li>2010年3月：Socket.io 第一版发布</li> <li>2011年5月：npm 1.0 发布</li> <li>...</li></ul> <p>诞生之初给业界带来两个先进的思想：模块化（CommonJS），包管理工具（npm），不可否认，这些思想已经成为前端不可缺少的部分。</p> <p>并且因为Node.js ，前端挣脱了浏览器的束缚，直接可以操作文件系统。于是大量的工具诞生:gulp，webpack，babel... 奠定了现代前端的基础</p> <h3 id="_2-node是什么"><a href="#_2-node是什么" class="header-anchor">#</a> 2.Node是什么</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>借用Node官网中的描述：Node.js 不是 JavaScript应用，不是编程语言，也不是像Nginx一样的web服务器，也不是框架。Node.js 是 JavaScript 的运行时环境</p> <p>你可以把Node.js 理解成一个库（当然称之为平台更合理），例如jQuery，里面有很多方法（API），只要想达成某些效果，就调用对应的方法即可</p></div> <blockquote><p>备注：Node现在也被应用于 人工智能（TensorFlow.js） &amp; 航空航天（CubeSat卫星）&amp; 物联网（Ruff，树莓派）</p></blockquote> <hr> <h2 id="🍡第二部分-node-io读写模块分享"><a href="#🍡第二部分-node-io读写模块分享" class="header-anchor">#</a> 🍡第二部分：Node（io读写模块分享）</h2> <h3 id="_1-fs文件系统"><a href="#_1-fs文件系统" class="header-anchor">#</a> 1.fs文件系统</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>首先 API总共有70多个，但是不要慌，这个数量除以二就行，因为所有的方法都有同步和异步两种</p></div> <p>1.文件读取</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;同步读取: &quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <p>2.文件写入</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'文件地址'</span><span class="token punctuation">,</span> <span class="token string">'覆盖写入文案'</span><span class="token punctuation">)</span> <span class="token comment">// 覆盖写入</span>
fs<span class="token punctuation">.</span><span class="token function">appendFileSync</span><span class="token punctuation">(</span><span class="token string">'文件地址'</span><span class="token punctuation">,</span> <span class="token string">'追加写入文案'</span><span class="token punctuation">)</span> <span class="token comment">// 追加写入</span>
</code></pre></div><hr> <p>3.删除文件</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span><span class="token string">'文件地址'</span><span class="token punctuation">)</span>
</code></pre></div><hr> <p>4.创建目录</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span><span class="token string">'目录地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <p>5.读取目录</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span><span class="token string">'目录地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <p>6.删除目录</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">rmdirSync</span><span class="token punctuation">(</span><span class="token string">'目录地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <p>7.获取文件或者文件夹信息</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> stats <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token string">'文件或文件夹路径'</span><span class="token punctuation">)</span>
stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 是否是文件</span>
stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 是否是文件夹</span>
</code></pre></div><h3 id="_2-steam-流"><a href="#_2-steam-流" class="header-anchor">#</a> 2.steam（流）</h3> <h5 id="node的流操作-主要是用来干什么的"><a href="#node的流操作-主要是用来干什么的" class="header-anchor">#</a> Node的流操作 主要是用来干什么的？</h5> <ul><li>主要是读写操作的，例如文件读取，文件写入等等</li> <li>这里大家是不是感觉和上面的文件系统功能重复了，答案是，是的</li></ul> <hr> <h5 id="为什么有了文件系统模块-fs-node还要有个流模块呢"><a href="#为什么有了文件系统模块-fs-node还要有个流模块呢" class="header-anchor">#</a> 为什么有了文件系统模块（fs），Node还要有个流模块呢？</h5> <p>例如上面我们的文件操作系统中的读取文件</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 如果文件过大，流入500MB，就会报如下的错误</span>
<span class="token comment">// buffer.js:382</span>
<span class="token comment">//     throw new Error('toString failed');</span>
<span class="token comment">// 报错原因是 Buffer 对象的长度过大，导致toString方法失败。 可见，这种一次获取全部内容的做法，不适合操作大文件。</span>
</code></pre></div><p>对于大文件读取 可以考虑使用流来读取文件内容。</p> <p>其实不要认为流模块只能用来读一下大文件，流文件的意义还在于流处理这种思路，因为Node.js 很是脆弱。Node虽然发展很快，但是有两个大问题一直困扰着像我这样的初级开发者，那就是 容错和性能</p> <p>容错指的是：因为JS是单线程解释性语言的，所以有一个地方报错，整个系统就挂掉了（现在又pm2可以挂掉重启）
性能指的是：一个Node程序只要涉及了IO操作，你啥都没干你的内存都有可能飚的很高。如果用传统的fs进行大量文件读取，系统直接就会卡死，所有流处理对IO操作高的系统的优化，起到了至关重要的作用。</p> <p>而 Node.js 自己的大量模块 也使用了 流处理模块，例如http模块，返回数据就使用了流处理模块，但是一想也是，如果没有流处理模块，你从Node服务器上下载一个 4k视频（几个G的那种），直接你的内存就占满了，而用流处理就不会有这种情况。</p> <hr> <h5 id="流处理为啥这么吊-原理是什么-它和fs模块不同的是什么"><a href="#流处理为啥这么吊-原理是什么-它和fs模块不同的是什么" class="header-anchor">#</a> 流处理为啥这么吊，原理是什么，它和fs模块不同的是什么</h5> <img src="https://user-gold-cdn.xitu.io/2018/4/2/16284fe7a88515ca?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"> <hr> <h5 id="node流处理的使用"><a href="#node流处理的使用" class="header-anchor">#</a> Node流处理的使用</h5> <p>Node.js 中有四种基本的流类型（我来讲前两种）</p> <ul><li>Readable - 可读的流 (例如 fs.createReadStream())。</li> <li>Writable - 可写的流 (例如 fs.createWriteStream())。</li> <li>Duplex - 可读写的流（双工流） (例如 net.Socket)。</li> <li>Transform - 在读写过程中可以修改和变换数据的 Duplex 流 (例如 zlib.createDeflate())。</li></ul> <hr> <h5 id="读取流"><a href="#读取流" class="header-anchor">#</a> 读取流</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建可读流</span>
<span class="token keyword">var</span> readerStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token constant">PATH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置编码为 utf8。</span>
<span class="token comment">// readerStream.setEncoding('UTF8');</span>

readerStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'chunk：'</span><span class="token punctuation">,</span> chunk<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

readerStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h5 id="写入流"><a href="#写入流" class="header-anchor">#</a> 写入流</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">'朱昆鹏'</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个可以写入的流，写入到文件 output.txt 中</span>
<span class="token keyword">var</span> writerStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'output.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用 utf8 编码写入数据</span>
writerStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token string">'UTF8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 标记文件末尾</span>
writerStream<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 处理流事件 --&gt; data, end, and error</span>
writerStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'finish'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;写入完成。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

writerStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;写入程序执行完毕&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h5 id="快速文件复制"><a href="#快速文件复制" class="header-anchor">#</a> 快速文件复制</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> readable <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'读取文件地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建读取流</span>
<span class="token keyword">let</span> writable <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'输出文件地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建写入流</span>
readable<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writable<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过管道来传输流</span>
</code></pre></div><hr> <h2 id="🍧第三部分-node-io读写模块实际应用-h5本地化平台"><a href="#🍧第三部分-node-io读写模块实际应用-h5本地化平台" class="header-anchor">#</a> 🍧第三部分：Node（io读写模块实际应用-H5本地化平台）</h2> <p>公司隐私，不放这，哈哈哈，想看来应聘吧</p> <h2 id="🍭第四部分-一些封装好的io读写模块函数分享"><a href="#🍭第四部分-一些封装好的io读写模块函数分享" class="header-anchor">#</a> 🍭第四部分：一些封装好的io读写模块函数分享</h2> <h3 id="_1-传入一个文件夹路径-返回这个文件夹下所有的文件路径数组"><a href="#_1-传入一个文件夹路径-返回这个文件夹下所有的文件路径数组" class="header-anchor">#</a> 1.传入一个文件夹路径，返回这个文件夹下所有的文件路径数组</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 传入一个文件夹路径，返回这个文件夹下所有的文件路径数组
 * @param { String } 文件夹路径
 * @return { Array } 此文件夹下所有的文件相对路径数组
 */</span>
<span class="token keyword">function</span> <span class="token function">readDirToPathArr</span><span class="token punctuation">(</span><span class="token parameter">foldPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> pathArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">function</span> <span class="token function">recursion</span><span class="token punctuation">(</span><span class="token parameter">foldPath<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>foldPath<span class="token punctuation">)</span>
    files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">===</span> <span class="token string">'.DS_Store'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> isDir <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>foldPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否是文件夹</span>
      isDir
        <span class="token operator">?</span> <span class="token function">recursion</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>foldPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token operator">:</span> pathArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>foldPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">recursion</span><span class="token punctuation">(</span>foldPath<span class="token punctuation">)</span>
  <span class="token keyword">return</span> pathArr
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="_2-复制某文件夹下所有的文件到另一个文件夹"><a href="#_2-复制某文件夹下所有的文件到另一个文件夹" class="header-anchor">#</a> 2.复制某文件夹下所有的文件到另一个文件夹</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 复制某文件夹下所有的文件到另一个文件夹
 * @param { String } 被复制的文件夹
 * @param { String } 目标文件夹
 */</span>
<span class="token comment">// 复制文件夹</span>
<span class="token keyword">function</span> <span class="token function">exists</span> <span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span> dst</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//测试某个路径下文件是否存在</span>
  fs<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exists</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>exists<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//不存在</span>
          <span class="token function">copy</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//存在</span>
          fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//创建目录</span>
              <span class="token function">copy</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span>dst<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 复制文件夹的辅助函数</span>
<span class="token keyword">function</span> <span class="token function">copy</span> <span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span> dst</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//读取目录</span>
  <span class="token keyword">let</span> paths <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
  paths<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> _src<span class="token operator">=</span>src<span class="token operator">+</span><span class="token string">'/'</span><span class="token operator">+</span>path<span class="token punctuation">;</span>
      <span class="token keyword">var</span> _dst<span class="token operator">=</span>dst<span class="token operator">+</span><span class="token string">'/'</span><span class="token operator">+</span>path<span class="token punctuation">;</span>
      <span class="token keyword">var</span> readable<span class="token punctuation">;</span>
      <span class="token keyword">var</span> writable<span class="token punctuation">;</span>
      fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>_src<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>st</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          
          <span class="token keyword">if</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              readable<span class="token operator">=</span>fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>_src<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建读取流</span>
              writable<span class="token operator">=</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>_dst<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建写入流</span>
              readable<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writable<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token function">exists</span><span class="token punctuation">(</span>_src<span class="token punctuation">,</span>_dst<span class="token punctuation">,</span>copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">exists</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">,</span> <span class="token string">'./b'</span><span class="token punctuation">)</span>
</code></pre></div><hr> <h3 id="_3-html文案抽离函数"><a href="#_3-html文案抽离函数" class="header-anchor">#</a> 3.HTML文案抽离函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cheerio'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">function</span> <span class="token function">extractFromText</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> options<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> $<span class="token punctuation">,</span> text<span class="token punctuation">;</span>
 
  text <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt; *(br|p|div|section|aside|button|header|footer|li|article|blockquote|cite|code|h1|h2|h3|h4|h5|h6|legend|nav)((.*?)&gt;)/g</span><span class="token punctuation">,</span> <span class="token string">'&lt;$1$2|||||'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt; *\/(td|a|option) *&gt;/g</span><span class="token punctuation">,</span> <span class="token string">' &lt;/$1&gt;'</span><span class="token punctuation">)</span> <span class="token comment">// spacing some things out so text doesn't get smashed together</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt; *(a|td|option)/g</span><span class="token punctuation">,</span> <span class="token string">' &lt;$1'</span><span class="token punctuation">)</span> <span class="token comment">// spacing out links</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt; *(br|hr) +\/&gt;/g</span><span class="token punctuation">,</span> <span class="token string">'|||||&lt;$1\\&gt;'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;\/ +?(p|div|section|aside|button|header|footer|li|article|blockquote|cite|code|h1|h2|h3|h4|h5|h6|legend|nav)&gt;/g</span><span class="token punctuation">,</span> <span class="token string">'|||||&lt;/$1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  text <span class="token operator">=</span> <span class="token string">'&lt;textractwrapper&gt;'</span> <span class="token operator">+</span> text <span class="token operator">+</span> <span class="token string">'&lt;textractwrapper&gt;'</span><span class="token punctuation">;</span>
 
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'noscript'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token keyword">const</span> $docElement <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'textractwrapper'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>includeAltText<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      text <span class="token operator">=</span> <span class="token function">getTextWithAlt</span><span class="token punctuation">(</span>$<span class="token punctuation">,</span> $docElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      text <span class="token operator">=</span> $docElement<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    text <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\|\|\|\|\|/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\n\u00A0|\u00A0\n|\n | \n)+/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\r\u00A0|\u00A0\r|\r | \r)+/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\v\u00A0|\u00A0\v|\v | \v)+/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\t\u00A0|\u00A0\t|\t | \t)+/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[\n\r\t\v]+/g</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用方法</span>
<span class="token function">extractFromText</span><span class="token punctuation">(</span>html文件的Buffer对象数据<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> resText</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/2.note/6.移动端/7.微信小程序.html" class="prev">
        7.微信小程序
      </a></span> <span class="next"><a href="/2.note/7.Node/2.原生Node.html">
        2.原生Node
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f2516ed4.js" defer></script><script src="/assets/js/2.b5be6ff6.js" defer></script><script src="/assets/js/73.51b916d0.js" defer></script><script src="/assets/js/3.87d40112.js" defer></script>
  </body>
</html>
