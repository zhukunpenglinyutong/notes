# 2.VueåŸºç¡€

::: tip
è¯´å®è¯ï¼ŒVueçš„å®˜ç½‘æ›´å¥½ä¸€äº›ï¼Œæˆ‘æœ‰ä¸€äº›å¿˜è®°çš„ï¼Œä¸ä¼šæ¥è¿™ï¼Œè€Œæ˜¯ç›´æ¥å»å®˜ç½‘

è¿™ä¸ªåªæ˜¯æˆ‘å½“åˆä¸ä¼šçš„æ—¶å€™æ•´ç†çš„å†…å®¹ï¼Œç°åœ¨ä¼šäº†ï¼Œå°±ç›´æ¥å»å®˜ç½‘äº†

å¦‚æœä½ è¿˜ä¸ä¼šï¼Œé‚£ä¹ˆå»ºè®®è‡ªå·±ä¹Ÿæ•´ç†ä¸€éå§ï¼Œç„¶åå†å»å®˜ç½‘
:::

---

## ğŸ¥œç¬¬ä¸€éƒ¨åˆ†ï¼šå‰è¨€

> æˆ‘æ„Ÿè§‰Vueçš„å®˜ç½‘å·²ç»å¾ˆè¯¦ç»†äº†ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³å†ç®€åŒ–ä¸€ç‚¹ï¼Œä½œä¸ºæˆ‘è‡ªå·±æŸ¥é˜…ä½¿ç”¨

### 1.ä¸ºä»€ä¹ˆè¦ç”¨Vue

> æˆ‘ä»¬æœ‰jQueryï¼Œä¸ºä»€ä¹ˆè¦ç”¨Vueï¼ŒVueå¥½åœ¨å“ªé‡Œ

- æ€§èƒ½æ›´å¥½
    - jQueryä¸»è¦æ˜¯æ“ä½œDOMçš„ä¸€ä¸ªåº“ï¼Œä½†æ˜¯æ“ä½œDOMæ˜¯ååˆ†æ¶ˆè€—æ€§èƒ½çš„ï¼Œä¿®æ”¹DOMä¼šå¯¼è‡´é‡ç»˜é‡æ’
    - è€ŒVueä½¿ç”¨ è™šæ‹ŸDOMï¼ˆä¸æ˜¯ä¸€ä¸ªçœŸå®çš„DOMï¼Œè€Œæ˜¯ç”±JSæ¥æ¨¡æ‹Ÿå‡ºæ¥çš„å…·æœ‰çœŸå®DOMç»“æ„çš„ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼‰ï¼Œæ€§èƒ½æ›´å¥½
    - è§ ä½¿ç”¨è™šæ‹ŸDOMåº“
- è§†å›¾ï¼Œæ•°æ®åˆ†ç¦»
    - ä¸»è¦æ˜¯æ¨¡æ¿å¼•æ“çš„ä½œç”¨ï¼Œè§å®ç°ä¸€ä¸ªæ¨¡æ¿å¼•æ“
- ç»´æŠ¤æˆæœ¬ä½

---

### 2.Vueä»‹ç»

> æ˜¯ä¸€å¥—ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼æ¡†æ¶



---

### 2.è™šæ‹ŸDOM

> DOMçš„æ“ä½œæ˜¯æ˜‚è´µçš„ï¼ŒJSçš„è¿è¡Œæ•ˆç‡æ›´é«˜ï¼Œå°†DOMå¯¹æ¯”æ”¾åˆ°JSå±‚ï¼Œå‡å°‘DOMæ“ä½œï¼Œæ•ˆç‡æ›´é«˜

[snabbdom](https://github.com/snabbdom/snabbdom) æ˜¯ä¸€ä¸ªæ¯”è¾ƒç«çš„ è™šæ‹ŸDOMåº“ï¼ŒVue2.0è™šæ‹ŸDOMå°±å€Ÿé‰´äº†è¿™ä¸ªåº“ï¼Œæˆ‘å¯ä»¥å…ˆä½¿ç”¨ä¸€ä¸‹è¿™ä¸ªåº“

```html
<body>

<div id="app">
    <!-- å±•ç¤ºçš„DOMèŠ‚ç‚¹ -->
    <!-- <div id="my">
        <h1 class="name">æœ±æ˜†é¹</h1>
        <h2>21</h2>
    </div> -->
</div>
<button id="ageAdd">å¹´é¾„+1</button>

<script src="https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom.min.js"></script>
<script>
    
    let app = document.getElementById('app')
    let ageAdd = document.getElementById('ageAdd')
    let data = { name: 'æœ±æ˜†é¹', age: 21 }
    let vNode = null;

    render() // åˆæ¬¡æ¸²æŸ“

    function render () {
        const patch = snabbdom.init([])
        const h = snabbdom.h

        let newVNode = h('div#my', {}, [
            h('h1.name', {}, [data.name]),
            h('h2', {}, [data.age])
        ])
        
        // è¿™ä¸ªå…¶å®å°±æ˜¯ä¼šè‡ªåŠ¨å¯¹æ¯”æ›´æ–°ï¼Œä¸çŸ¥é“æ˜¯å¦æ˜¯Diffç®—æ³•
        if (vNode) {
            patch(vNode, newVNode)
        } else {
            patch(app, newVNode)
        }

        vNode = newVNode
    }

    // å¹´é¾„åŠ ä¸€ç‚¹å‡»äº‹ä»¶
    ageAdd.onclick = function () {
        data.age += 1
        render()
    }

</script>
</body>
```

---

### 3.æ¨¡æ¿å¼•æ“è§£æ

---

### 4.åŒå‘æ•°æ®ç»‘å®šå®ç°åŸç†

---

## ğŸ¯ç¬¬äºŒéƒ¨åˆ†ï¼šVueåŸºç¡€

### 1.å®‰è£…

---

### 2.åˆ›å»ºå®ä¾‹

```html
<body>
    <div id="app">
        <p>å§“åï¼š{{my.name}}</p>
        <p>å¹´é¾„ï¼š{{my.age}}</p>
        <p>æ•°ç»„ï¼š{{my.arrTest}}</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script>
        
        let vm = new Vue({
            el: '#app', // è§„å®šæ¸²æŸ“çš„è·¯å¾„
            data: { // æ’å€¼è¡¨è¾¾å¼æ¸²æŸ“çš„æ•°æ®
                my: {
                    name: 'æœ±æ˜†é¹',
                    age: 21,
                    arrTest: [1,2,3]
                }
            }
        })

        // dataä¸­çš„æ•°æ®ï¼Œæœ€åä¼šæ”¾åˆ° vm ä¸Šï¼Œä¹Ÿå°±æ˜¯ vm.my.name æ˜¯ æœ±æ˜†é¹ï¼ˆå…¶å®methodsä¹Ÿä¼šæ”¾åˆ° vmä¸Šï¼‰

    </script>
</body>
```

---

### 3.æ•°ç»„ï¼Œå¯¹è±¡é—®é¢˜

> 2.åˆ›å»ºå®ä¾‹ä¸­ï¼Œæœ‰ä¸ªæ•°ç»„çš„ç¤ºä¾‹ï¼Œä½†æ˜¯æœ‰ä¸€äº›é—®é¢˜ï¼Œå…¶å®å¯¹è±¡ä¹Ÿæœ‰è¿™äº›é—®é¢˜

- vm.my.arrTest = [1,2,3,4] æ²¡é—®é¢˜ï¼Œå¯ä»¥å˜
- vm.my.arrTest.push(4)  æ²¡é—®é¢˜ï¼Œå¯ä»¥å˜
- â vm.my.arrTest[0] = 5 å˜ä¸äº†
- â vm.my.arrTest.length = 1 å˜ä¸äº†

**â£ï¸ æ›´æ–°çš„åŸç†æ˜¯ Object.definePropertyï¼Œå…¶å®æ˜¯ç›‘å¬ä¸åˆ° å¼•ç”¨å¯¹è±¡é‡Œé¢æ•°æ®æ”¹å˜çš„**

**ğŸ”¥ æ•°ç»„è§£å†³æ–¹æ³•ï¼šä¹Ÿå°±æ˜¯æ•°ç»„ push ä¹Ÿä¸èƒ½è§¦å‘ï¼Œä½†æ˜¯Vueæ”¹å†™äº† æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œè¿™ä¸ªç§°ä¹‹ä¸º æ•°ç»„å˜å¼‚æ–¹æ³•ï¼Œé™¤äº† push è¿˜æœ‰ pop, shift, unfhift, sort, reverse, splice**

**ğŸ”¥ å¯¹è±¡è§£å†³æ–¹æ³•ï¼šé€šè¿‡ $set(è¦æ”¹çš„æ˜¯è°ï¼Œè¦æ”¹æˆä»€ä¹ˆï¼Œæ”¹æˆä»€ä¹ˆæ ·çš„çš„å€¼)ï¼Œä¸€èˆ¬å¸¸ç”¨äºå¯¹è±¡**

**æ‹“å±•ï¼švm.$el è¡¨ç¤ºæˆ‘ä»¬é‚£ä¸ª app çš„DOM**

**æ‹“å±•ï¼švm.$nextTick() å†æ¬¡æ¸²æŸ“DOMä¹‹åçš„ï¼Œä¾‹å¦‚vm.my.age = 23ï¼Œvm.$el.innerText å…¶å®è·å–çš„æ˜¯ä¸Šä¸€ä¸ªçŠ¶æ€çš„ï¼Œæ€ä¹ˆæ‰èƒ½æ‹¿åˆ°æ¸²æŸ“ä¹‹åçš„DOMå‘¢ï¼Œå°±éœ€è¦ vm.$nextTick(() => {})**

**æ‹“å±•ï¼švm.$mount() æŒ‚è½½å…ƒç´ **

---

### v-preï¼ˆä¼šè·³è¿‡æ¨¡æ¿è§£æè¿‡ç¨‹ï¼‰

```js
<div>{{name}}</div> // è¾“å‡ºæœ±æ˜†é¹
<div v-pre>{{name}}</div> // è¾“å‡º {{name}}
```

---

### v-cloakï¼ˆåœ¨æ¨¡æ¿è§£æä¹‹å‰å­˜åœ¨ï¼Œç¼–è¯‘ä¹‹åæ¶ˆé™¤ï¼‰

```js
// è¿™ä¸ªæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œå› ä¸ºé¡µé¢æ˜¯å…ˆåŠ è½½DOMä¹‹åï¼Œæ‰åŠ è½½JSï¼Œç„¶åVueæ‰åŠ¨ç”¨æ¨¡æ¿è§£æï¼Œè¿›è¡Œæ¸²æŸ“çš„ï¼Œä¹Ÿå°±æ˜¯é¡µé¢æœ‰æ®µæ—¶é—´ï¼Œæ˜¯ {{}} è¿™ç§çš„å±•ç¤ºå½¢å¼ï¼Œè¿™ç§ä½“éªŒä¸å¥½ï¼Œå¯ä»¥ç”¨ cloak è¿›è¡Œå ä½

// ä½¿ç”¨æ–¹å¼æ˜¯ä¸»è¦é…åˆcssè¿›è¡Œ
[v-clock] {
    display: none
}

<div id="app">
    <div v-cloak></div>
</div>
```

---

### v-onceï¼ˆè®©æŸä¸ªå…ƒç´ ä¸å†æ›´æ”¹ï¼‰

å†…éƒ¨åŸç†æ˜¯ä½¿ç”¨äº†ç¼“å­˜

```js
<div v-once>{{name}}</div> // æœ±æ˜†é¹

// vm.name = 111 è§†å›¾ä¸å˜ï¼ˆåŸç†æ˜¯è°ƒç”¨äº†ç¼“å­˜ï¼‰
```

---

### v-htmlï¼ˆæ¸²æŸ“ç½‘é¡µå†…å®¹ï¼‰

åº•å±‚åŸç†æ˜¯innerHtml

```js
<div v-html="domData"></div> // å®¹æ˜“é€ æˆXSSæ”»å‡» 
```

---

### v-textï¼ˆæ¸²æŸ“æ–‡æœ¬ï¼‰

ä½¿ç”¨v-textçš„æ ‡ç­¾ï¼Œå†…éƒ¨å†…å®¹éƒ½ä¼šè¢«æ›¿æ¢å±‚ v-textç»‘å®šçš„å†…å®¹ï¼Œåº•å±‚åŸç†æ˜¯ innerText

```js
<div v-text="age">{{name}}</div> // 21
```

---

### v-if v-else v-else-if

```js
<div v-if="isShow">ç¤ºä¾‹1</div>
<template v-else-if="isShow2">ç¤ºä¾‹2</template>
<template v-else>ç¤ºä¾‹3</template>
<div></div>
```

---

### v-show

```js
<div v-show="isShow">ç¤ºä¾‹</div>
```

---

### v-if å’Œ v-showçš„åŒºåˆ«

- v-if æ˜¯çœŸæ­£è®©å…ƒç´ æ¶ˆå¤±ï¼Œæˆ–è€…æ’å…¥
- v-show æ˜¯æ§åˆ¶cssï¼Œè®©å…¶æ˜¾ç¤ºæˆ–è€…éšè—ï¼Œå¹¶ä¸”ä¸æ”¯æŒtemplateæ ‡ç­¾

---

### v-bindï¼ˆå½“å±æ€§æƒ³ä½¿ç”¨æ•°æ®çš„æ—¶å€™ï¼‰

```js
<img v-bind:src="url"></src>

// ç»‘å®šå¤šä¸ªclass :class="[class1, class2]" æˆ–è€… :class="{ class1: isClassShow1, class2: isClassShow2 }" æˆ–è€… [class1, isShow ? '' : '']
// ç»‘å®šå¤šä¸ªstyle :style="[style1, style2]"ï¼Œ{} å’Œ [] éƒ½å’Œ ç»‘å®šå¤šä¸ª class ä¸€è‡´
// :style æ ·å¼æ˜¯ä¼šè¦†ç›– styleæ ·å¼çš„
```

---

### v-onï¼ˆäº‹ä»¶ï¼Œè¯»å– methodsé‡Œé¢çš„å‡½æ•°ï¼‰

```js
<button v-on="click">ç‚¹å‡»</button>

new Vue({
    el: '#app',
    data: {},
    methods: {
        click () {
            alert('æ‰“å°')
        }
    }
})
```

---

### v-for

```js
// æ³¨æ„ :key ä¸èƒ½å†™åˆ° template ä¸Š
<template v-for="(item, index) in arrData">
    <p :key="item.id">{{ index }} : {{ item }}</p>
</template>

// æ‹“å±•ï¼šè¿˜èƒ½éå†æ•°å­—ï¼Œå­—ç¬¦ä¸²
<template v-for="item in 5">{{item}}</template> // 1 2 3 4 5
<template v-for="item in 'zhu'">{{ item }}</template> // z h u
```

---

### v-modelï¼ˆåŒå‘æ•°æ®ç»‘å®šï¼‰

**ä¸»è¦ç”¨äºè¾“å…¥æ¡†ï¼Œåšäº†ä¸€å±‚ç®€å•çš„ä¼˜åŒ–ï¼Œä½¿ä¹‹æœ‰åŒå‘ç»‘å®šçš„æ•ˆæœï¼Œæ•ˆæœå°±æ˜¯ï¼Œè¾“å…¥æ¡†å†…æ•°æ®æ”¹å˜ï¼Œdataä¸­çš„æ•°æ®ä¹Ÿä¸€èµ·æ”¹å˜**

åŸç†è§£æï¼šç›‘å¬ input å€¼æ”¹å˜äº‹ä»¶ï¼Œå°†æ”¹å˜çš„å€¼ï¼Œèµ‹äºˆ v-model ç»‘å®šçš„ å±æ€§ï¼Œæœ¬è´¨ä¸Šæ˜¯ input + value è¯­æ³•ç³–

```js
<input v-model="name" /> // æ™®é€šè¾“å…¥æ¡†
<textarea v-model="text"></textarea>

<input type="checkbox" v-model="checked" /> // å•é€‰æ¡†
// å¤šé€‰æ¡†ä¹Ÿå¯ä»¥ï¼Œå¤šé€‰æ¡† v-model åº”è¯¥ç»‘å®šæ•°ç»„æ ¼å¼
// å•é€‰æ¡†ä¹Ÿå¯ä»¥

// selectä¹Ÿå¯ä»¥ï¼ˆå¤šé€‰å°†æ•°æ®æ ¼å¼è°ƒæˆæ•°ç»„å°±è¡Œï¼‰
<select v-model="selected">
    <option value="" disabled>è¯·é€‰æ‹©</option>
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
</select>
```

---

### å•å‘æ•°æ®æµ å’Œ åŒå‘æ•°æ®ç»‘å®šåŸç†æ¢ç´¢ä»¥åŠå®ç°

---

### ä¿®é¥°ç¬¦

---

### å†™ä¸€ä¸ªtodoList

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id="app">

        <input type="text" v-model="task">
        <button @click="addTask($event, 'click')">æäº¤</button>

        <p>æ­£åœ¨æ·»åŠ çš„ä»»åŠ¡ï¼š{{task}}</p>
        <h4>æ‰€æœ‰ä»»åŠ¡</h4>
        
        <ul>
            <li v-for="(task, index) in taskList" :key="index">
                {{task}}
                <button @click="deleteTask(index)">åˆ é™¤</button>
            </li>
        </ul>

    </div>

    <script src="https://cn.vuejs.org/js/vue.js"></script>
    <script>

        // è‡ªå®šä¹‰æŒ‰é”®ä¿®é¥°ç¬¦åˆ«åï¼ˆé”®ç›˜äº‹ä»¶ï¼Œé¼ æ ‡äº‹ä»¶, v-modelç­‰éƒ½èƒ½ç”¨ä¿®é¥°ç¬¦ï¼‰
        // Vue.config.keyCodes = {
        //     'f1-key': 112
        // }

        // ä¾‹å¦‚ v-model.lazy åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œv-model åœ¨æ¯æ¬¡ input äº‹ä»¶è§¦å‘åå°†è¾“å…¥æ¡†çš„å€¼ä¸æ•°æ®è¿›è¡ŒåŒæ­¥ (é™¤äº†ä¸Šè¿°è¾“å…¥æ³•ç»„åˆæ–‡å­—æ—¶)ã€‚ä½ å¯ä»¥æ·»åŠ  lazy ä¿®é¥°ç¬¦ï¼Œä»è€Œè½¬å˜ä¸ºä½¿ç”¨ change äº‹ä»¶è¿›è¡ŒåŒæ­¥
        // ä¾‹å¦‚ v-model.number å°†è¾“å…¥çš„ç»‘å®šå˜ä¸ºæ•°å­—ç±»å‹
        // ä¾‹å¦‚ v-model.trim å¦‚æœè¦è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„é¦–å°¾ç©ºç™½å­—ç¬¦
        
        let vm = new Vue({
            el: '#app',
            data: {
                task: '',
                taskList: []
            },
            methods: {
                addTask (e, type) {

                    // ğŸ”¥ğŸ”¥ğŸ”¥ è¿™ä¸ªå°±èƒ½ä¼ é€’ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œå¾ˆå¥½ï¼Œè§£å†³äº†ä¼ å‚åŒæ—¶è¿˜æƒ³è¦ äº‹ä»¶å¯¹è±¡e çš„éœ€æ±‚
                    console.log(e, type)

                    this.taskList.push(this.task)
                    this.task = ''
                },
                deleteTask (index) {
                    this.taskList.splice(index, 1)
                }
            }
        })

    </script>
</body>
</html>
```

---

## ğŸ–ç¬¬ä¸‰éƒ¨åˆ†ï¼šVueè¿›é˜¶

### 1.è‡ªå®šä¹‰æŒ‡ä»¤ï¼ˆdirectiveï¼‰

> å…¨å±€æŒ‡ä»¤ï¼ŒæŒ‚è½½Vueæ„é€ å‡½æ•°ä¸­ï¼Œæ‰€æœ‰å®ä¾‹éƒ½èƒ½ä½¿ç”¨ï¼Œå±€éƒ¨æŒ‡ä»¤ï¼ŒæŒ‚åˆ°å…·ä½“å®ä¾‹ä¸­

**ä¾‹å¦‚æˆ‘ä»¬éœ€æ±‚æ˜¯ï¼Œè®© input æ ‡ç­¾ æœ€å¤šåªèƒ½è¾“å…¥5ä¸ªå­—ç¬¦**

```html
<body>
    <div id="app">
        <input type="text" v-model="content" v-slice="content">
    </div>

    <script src="https://cn.vuejs.org/js/vue.js"></script>
    <script>

        Vue.directive('slice', (el, bindings, vnode) => {
            
            // console.log('el', el) // æŒ‡ä»¤æ‰€åœ¨çš„DOMå…ƒç´ 
            // console.log('bindings', bindings) // è‡ªå®šä¹‰æŒ‡ä»¤å¯¹è±¡æ•°æ®ï¼Œå¯ä»¥è®¾ç½®ï¼Œä¼ å‚ï¼Œç­‰ç­‰
            // console.log('vnode', vnode) // è™šæ‹ŸèŠ‚ç‚¹

            // è·å–v-sliceè·å–çš„å€¼ï¼Œå¹¶æˆªå–
            const val = bindings.value.slice(0, 5)
            vnode.context.content = val


        })

        let vm = new Vue({
            el: '#app',
            data: {
                content: ''
            }
        })

    </script>
</body>
```

---

**è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œå‚æ•°äºŒè¿˜èƒ½ä¼ é€’å¯¹è±¡**

[å®˜æ–¹æ•™ç¨‹...](https://cn.vuejs.org/v2/guide/custom-directive.html)


---

**å±€éƒ¨è‡ªå®šä¹‰æŒ‡ä»¤æ˜¯éœ€è¦åœ¨å®ä¾‹ä¸Šå†™ directiveså±æ€§**

```js
new Vue({
    el: '#app',
    directives: {}
})
```

---

### 2.è‡ªå®šä¹‰æŒ‡ä»¤è¿›é˜¶

---

### 3.è¿‡æ»¤å™¨ï¼ˆfilterï¼‰

> åœ¨ä¸æ”¹å˜åŸæœ‰æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæ”¹å˜äº†å±•ç¤ºçš„æ•°æ®

```js
// ä¾‹å¦‚æˆ‘ä»¬å°† 1000000 å˜ä¸º 1,000,000 è¿™ç§å±•ç¤ºå½¢å¼

<div id="app">
    {{ num | toNum(2) | è¿‡æ»¤å™¨äºŒ | ...}} 
</div>

// å…¨å±€è¿‡æ»¤å™¨
Vue.filter('toNum', (value, times) => {
    console.log('åŸæ¥çš„æ•°æ®', value)
    console.log('å‚æ•°', times)

    return å¤„ç†ä¹‹åçš„æ•°æ®
})

// â£ï¸ æœ‰ç§å‡½æ•°å¼ç¼–ç¨‹çš„æ„Ÿè§‰
```

[è¿‡æ»¤å™¨å®˜æ–¹æ–‡æ¡£...](https://cn.vuejs.org/v2/guide/filters.html)

---

### 4.el template render

**é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬å†™åˆ° div#app é‡Œé¢çš„ä¸œè¥¿ï¼Œå°±èƒ½ä½¿ç”¨ Vueçš„è¯­æ³•äº†ï¼Ÿ**

è¿‡ç¨‹æ˜¯ï¼šé€šè¿‡elæ¥ç¡®å®šè¯»å–é‚£ä¸ªæ ‡ç­¾é‡Œé¢çš„å†…å®¹ï¼ˆHTMLå­—ç¬¦ä¸²ï¼‰ ---> ç”ŸæˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œå…¶å®è¿™ä¸€æ­¥å°±å·²ç»å°†æ’å€¼è¡¨è¾¾å¼è½¬æ¢äº† ---> é€šè¿‡render ç”Ÿæˆ Vnode ---> å˜æˆçœŸæ˜¯çš„DOMå…ƒç´ 

**â£ï¸ å¤‡æ³¨ï¼šelå…¶å®è¿˜èƒ½ä¼ çœŸå®çš„DOMèŠ‚ç‚¹ï¼Œå¦‚æœä¸å†™elçš„è¯ï¼Œä¼šçœ‹æœ‰æ²¡æœ‰ $mount,ä¸ä¼šè§£æäº†**

---

**å¦‚æœæœ‰äº† template ï¼Œé‚£ä¹ˆä¼šæ€ä¹ˆè§£æå‘¢ï¼Ÿ**

é¦–å…ˆåˆ¤æ–­æ˜¯å¦æœ‰ elï¼ˆæ²¡æœ‰å°±çœ‹æ˜¯å¦æœ‰ $mountï¼‰---> ç„¶ååˆ¤æ–­æ˜¯å¦æœ‰ templateï¼ˆæ²¡æœ‰çš„è¯ template = $el.outerHTMLï¼Œä¹Ÿå°±æ˜¯ el#appé‡Œé¢çš„å†…å®¹ï¼‰---> ç”ŸæˆAST ---> render ---> vnode ---> çœŸå®DOM

---

**render ?**

```js
<body>
    <div id="app">
        <p>{{ name }}</p>
    </div>
            
    <script src="https://cn.vuejs.org/js/vue.js"></script>
    <script>

        new Vue({
            el: '#app',
            data: { name: 'æœ±æ˜†é¹' },
            template: '<h1>æˆ‘æ˜¯templateï¼Œæœ‰äº†æˆ‘ï¼Œdiv#appé‡Œé¢çš„å†…å®¹å°±ä¼šè¢«æˆ‘æ›¿ä»£</h1>',
            // h å…¶å®æ˜¯ createElement
            render (h) {
                return h('h1', 'æˆ‘æ˜¯renderå‡½æ•°ï¼Œæœ‰äº†æˆ‘ template div#appé‡Œé¢çš„å†…å®¹éƒ½è¢«æˆ‘æ›¿ä»£ï¼Œæˆ‘æ˜¯æœ€åæ­¥éª¤')
            }
        })

    </script>
</body>
```

---

### 5.æ¸²æŸ“å‡½æ•° & JSX

[å®˜æ–¹æ–‡æ¡£...](https://cn.vuejs.org/v2/guide/render-function.html)

---

### 6.ç”Ÿå‘½å‘¨æœŸ

> æ‰§è¡Œåˆ°æŸä¸ªé˜¶æ®µï¼Œè‡ªå·±å»æ‰§è¡Œçš„å‡½æ•°,åªè¦å°†æ¸²æŸ“æµç¨‹ææ‡‚ï¼Œå°±å¾ˆæ¸…æ™°äº†ï¼ˆè¦æƒ³ç†è§£ï¼Œè¿˜æ˜¯è¦çœ‹å®˜ç½‘çš„è¿™å¼ å›¾ï¼Œå¾ˆæ˜¯ç»å…¸ï¼‰

<img src="https://cn.vuejs.org/images/lifecycle.png" />

---

### 7.è®¡ç®—å±æ€§å’Œä¾¦å¬å™¨


```html
<body>
    <div id="app">
        <p>{{ helloName }}</p>
    </div>
            
    <script src="https://cn.vuejs.org/js/vue.js"></script>
    <script>

        let vm = new Vue({
            el: '#app',
            data: { name: 'æœ±æ˜†é¹' },
            computed: {
                helloName () {
                    return this.name + 'ï¼Œä½ å¥½'
                }
            },
            watch: {
                name () {
                    console.log('åˆå§‹åŒ–çš„æ—¶å€™ä¸è§¦å‘ï¼Œåªæœ‰æ”¹å˜çš„æ—¶å€™è§¦å‘')
                },
                // ä¹Ÿå¯ä»¥å†™æˆå¯¹è±¡
                // name: {
                //     handler () {

                //     },
                //     immediate: true // è¿™ä¸ªå°±å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¹Ÿæ‰§è¡Œ
                // }
            }
        })

        // å¦ä¸€ç§å†™ç›‘å¬å™¨çš„æ–¹æ³•
        vm.$watch('name', () => {

        }, {
            immediate: true
        })

    </script>
</body>
```

---

### 8.è®¡ç®—å±æ€§å’Œä¾¦å¬å™¨çš„åŒºåˆ«

---

## ğŸ”ç¬¬å››éƒ¨åˆ†ï¼šVueç»„ä»¶

> å‰è¨€ï¼šä¸ºä»€ä¹ˆVueè¿™ç§ MVVMæ¡†æ¶ï¼Œå¾ˆå¿«å°±æŠŠjQueryæ›¿ä»£äº†ä¸‹å»ï¼Œæˆ‘æƒ³ï¼Œç»„ä»¶åŒ–å°±æ˜¯å¾ˆé‡è¦çš„å› ç´ 

### 1.ç»„ä»¶çš„å®šä¹‰ä¸ä½¿ç”¨

```html
<body>
    <div id="app">
        <!-- <p>{{ name }}</p> -->
        <my-name></my-name>
    </div>
            
    <script src="https://cn.vuejs.org/js/vue.js"></script>
    <script>

        // å…¨å±€ç»„ä»¶
        // æ³¨æ„ï¼šåç§°å¯ä»¥å†™æˆ my-name æˆ–è€… myName
        Vue.component('my-name', {
            template: `<div>{{name}}</div>`,
            data () {
                return {
                    name: 'æœ±æ˜†é¹ï¼ˆå…¨å±€ç»„ä»¶ï¼‰'
                }
            }
        })

        new Vue({
            el: '#app',
            data: { name: 'æœ±æ˜†é¹' },
            // å±€éƒ¨ç»„ä»¶
            components: {
                myName: {
                    template: `<div>{{name}}</div>`,
                    data () {
                        return {
                            name: 'æœ±æ˜†é¹ï¼ˆå±€éƒ¨ç»„ä»¶ï¼‰'
                        }
                    }
                }
            }
        })

    </script>
</body>
```

---

### 2.ç»„ä»¶æ•°æ®ä¼ é€’ï¼ˆpropsï¼‰

```html
<body>
    <div id="app">
        <!-- <p>{{ name }}</p> -->
        <my-name name="æœ±æ˜†é¹ï¼ˆæ•°æ®ä¼ é€’ï¼‰"></my-name>
    </div>
            
    <script src="https://cn.vuejs.org/js/vue.js"></script>
    <script>

        // åç§°å¯ä»¥å†™æˆ my-name æˆ–è€… myName
        Vue.component('my-name', {
            template: `<div>{{name}}</div>`,
            props: {
                name: {
                    type: String, // éœ€è¦ä¼ çš„æ˜¯å­—ç¬¦ç±»å‹
                    required: true, // å¿…ä¼ 
                    default: 'é»˜è®¤å€¼', // é»˜è®¤å€¼ï¼Œå¦‚æœé»˜è®¤å€¼æ˜¯å¼•ç”¨ç±»å‹ï¼Œéœ€è¦è¿™ä¹ˆå†™ () => {xxx} , æ•°ç»„ä¹Ÿæ˜¯ä¸€æ · () => [xxx]
                    validator (value) { // å±æ€§æ ¡éªŒ
                        // å†™æ¡ä»¶ï¼Œå¦‚æœä¸ºfalseä¼šæŠ¥è­¦å‘Š
                        return true
                    }
                }
            }
        })

        new Vue({
            el: '#app',
            data: {}
        })

    </script>
</body>
```

[å®˜æ–¹æ–‡æ¡£...](https://cn.vuejs.org/v2/guide/components-props.html)

---

### 3.ç»„ä»¶é€šä¿¡

- props
- $emit/$on
- event bus
- $parent
- $root
- $children
- $refs
- $attrs
- $listeners
- provide/inject
- vuex

> é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆæœ‰é‚£ä¹ˆå¤šç§ç»„ä»¶é€šä¿¡çš„æ‰‹æ®µï¼Œç”¨Vuexä¸èƒ½è§£å†³æ‰€æœ‰é—®é¢˜ä¹ˆï¼Ÿ

å¦‚æœä½ è¦å†™ä¸€ä¸ªç»„ä»¶åº“ï¼Œé‡Œé¢çš„ç»„ä»¶é€šä¿¡éš¾é“è¦ä¾èµ–Vuexä¹ˆï¼Œå¯ä»¥å›æƒ³ä¸€ä¸‹ï¼Œç›®å‰çš„ç»„ä»¶åº“ï¼Œä¼¼ä¹éƒ½æ²¡æœ‰è®©ä½ å®‰è£…Vuex

æ‰€ä»¥ï¼Œè¶Šå¾€æ·±å¤„å­¦ï¼Œå°±è¶Šèƒ½äº†è§£åˆ°ï¼Œä¸Šé¢æ¯ç§çš„è¯•ç”¨åœºæ™¯

---

> é—®é¢˜äºŒï¼š$refs å’Œ  $chilren çš„åŒºåˆ«

$refs ä¸ç®¡æ˜¯åŸç”Ÿçš„æ ‡ç­¾è¿˜æ˜¯è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œéƒ½å¯ä»¥è·å–

$chilren åªèƒ½è·å–è‡ªå®šä¹‰ç»„ä»¶

---

### 4.ç»„ä»¶é€šä¿¡ ä»£ç ç¤ºä¾‹

<img src="https://itzkp-1253302184.cos.ap-beijing.myqcloud.com/notes/2.notes/5.MVVM%E6%A1%86%E6%9E%B6%EF%BC%88Vue%EF%BC%89/Vue%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1.png" />

**App.vue**

```html
<template>
  <div>
    <h3>æ ¹èŠ‚ç‚¹</h3>
    <hr />

    <Children1 name="æ ¹èŠ‚ç‚¹ é€šè¿‡ props ä¼ ç»™ å„¿å­èŠ‚ç‚¹çš„æ•°æ®"></Children1>
  </div>
</template>

<script>
import Children1 from './components/Children1.vue'

export default {
  components: {
    Children1
  }
}
</script>

<style>
button {
  display: block;
}
</style>

```

**Children1.vue**

```html
<template>
  <div>
    <h3>èŠ‚ç‚¹1</h3>

    <div>{{ name }}</div>
    <div>{{ $attrs.attrsTest }}</div>

    <button @click="sendTo">èŠ‚ç‚¹1 é€šè¿‡ $emit/$on å‘é€æ•°æ®ï¼ˆå¯ä»¥è·¨å±‚çº§ï¼‰</button>
    <button @click="childrenEvent">é€šè¿‡ $chilren æ”¹å˜ å­èŠ‚ç‚¹æ•°æ®</button>
    <button @click="refsEvent">é€šè¿‡ $refs æ”¹å˜ å­èŠ‚ç‚¹å€¼æ•°æ®</button>
    <button @click="provideNum += 1">æµ‹è¯• provide/inject ä¸æ˜¯å“åº”å¼ {{ provideNum }}</button>

    <hr />

    <Children2 attrsTest="æœªåœ¨ props å£°æ˜çš„ï¼Œå¯ä»¥ä½¿ç”¨ $attrs ä½¿ç”¨ï¼ˆéå±æ€§ç‰¹æ€§ï¼‰ï¼Œä¸­é—´èŠ‚ç‚¹ å¯ä»¥é€šè¿‡ v-bind='$attrs' è¿›è¡Œè½¬å‘" ref="father"></Children2>
  </div>
</template>

<script>
import Children2 from './Children2.vue'

export default {
  provide() {
    return {
      provideText: `é€šè¿‡ provide/inject è·¨å±‚çº§ä¼ å€¼ï¼ˆæ³¨æ„ï¼šè¿™ä¸ªä¸æ˜¯å“åº”å¼çš„ï¼‰${this.provideNum}`
    }
  },
  components: {
    Children2
  },
  props: {
    name: {
      type: String
    }
  },
  data() {
    return {
      provideNum: 0
    }
  },
  mounted() {
  },
  methods: {
    // é€šè¿‡$emit/$onè·¨å±‚çº§å‘é€æ•°æ®
    sendTo() {
      this.$bus.$emit('sendRootText', 'é€šè¿‡ $emit/$on è·¨å±‚çº§å‘é€æ•°æ®')
    },
    // é€šè¿‡$childrenä¼ å€¼
    childrenEvent() {
      this.$children[0].text = 'çˆ¶ç»„ä»¶ é€šè¿‡ $children æ”¹å˜ å­ç»„ä»¶çš„å€¼'
    },
    // é€šè¿‡$refsä¼ å€¼
    refsEvent() {
      this.$refs.father.text = 'çˆ¶ç»„ä»¶ é€šè¿‡ $refs æ”¹å˜ å­ç»„ä»¶çš„å€¼'
    }
  }
}
</script>
```

---

**Children2.vue**

```html
<template>
  <div>
    
    <h3>èŠ‚ç‚¹2</h3>

    <button @click="getText">é€šè¿‡ $parent è·å–ç›´æ¥çˆ¶ç»„ä»¶ ä¿¡æ¯</button>

    {{ text }}

    <hr />

    <Children3 v-bind="$attrs"></Children3>
  </div>
</template>

<script>
import Children3 from './Children3.vue'

export default {
  components: {
    Children3
  },
  data() {
    return {
      text: ''
    }
  },
  mounted() {
    this.$bus.$on('sendRootText', text => {
      console.log('text', text)
      this.text = text
    })
  },
  methods: {
    getText() {
      // å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶æ–¹æ³•
      console.log('this.$parent', this.$parent);
    }
  }
}
</script>
```

---

**Children3.vue**

```html
<template>
  <div>
    <h3>èŠ‚ç‚¹3</h3>

    <div>{{ text }}</div>

    <div>{{ provideText }}</div>
    <div>{{ $attrs.attrsTest }}</div>
  </div>
</template>

<script>
export default {
  inject: ['provideText'],
  data() {
    return {
      text: ''
    }
  },
  mounted() {
    this.$bus.$on('sendRootText', text => {
      console.log('text', text)
      this.text = text
    })
  }
}
</script>
```

---

### 5.æ’æ§½

```html
<!-- åŒ¿åæ’æ§½ -->
<slot></slot>
<template></template>

<!-- å…·åæ’æ§½ å®šä¹‰ -->
<slot name="header"></slot>
<!-- å…·åæ’æ§½ ä½¿ç”¨ -->
<template v-slot:header></template>

<!-- ...... -->
```

---

> åè¯ï¼šç»„ä»¶åŒ–æ˜¯ä¸€ä¸ªå…¬å¸å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œå¦‚æœä¸€ä¸ªæˆ‘å…¬å¸æ²¡æœ‰è‡ªå·±çš„ç»„ä»¶åº“ï¼Œé‚£ä¹ˆæ•ˆç‡å°±æœ‰å¾ˆå¤§çš„é—®é¢˜ï¼Œå¦‚æœæƒ³è¿›ä¸€æ­¥å­¦ä¹ Vueç»„ä»¶åŒ–çš„æ€æƒ³ï¼Œé‚£ä¹ˆå¯ä»¥å»çœ‹ [Element.ui æºç ](https://github.com/ElemeFE/element)
