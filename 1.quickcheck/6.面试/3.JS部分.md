# 3.JSéƒ¨åˆ†

---

### ç¬¬ä¸€é¢˜ï¼š['1', '2', '3'].map(parseInt) what & why ? (ğŸ”¥JSçš„æ˜ å°„ä¸è§£æ)ï¼ˆåŸºæœ¬è¯­æ³•ï¼‰

```js
æ­£å¸¸ä¼šæƒ³æ˜¯ [1, 2, 3] å…¶å®æ˜¯ [1, NaN, NaN] ï¼Ÿ

// â£ï¸ map() åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°åè¿”å›çš„ç»“æœ ï¼ˆå‚æ•°ä¸€ï¼šå›è°ƒä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´ ï¼Œå‚æ•°äºŒï¼šå½“å‰å…ƒç´ çš„ç´¢å¼•ï¼Œå‚æ•°ä¸‰...ï¼‰
// â£ï¸ parseInt() å‡½æ•°è§£æä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å®šåŸºæ•°çš„æ•´æ•° (æ•°å­¦ç³»ç»Ÿçš„åŸºç¡€)ï¼ˆå‚æ•°ä¸€è¦å¤„ç†çš„æ•° | å‚æ•°äºŒåŸºæ•°ï¼Œé»˜è®¤ä¸º10ï¼Œå¯ä»¥ç†è§£ä¸ºè¿›åˆ¶ï¼‰

// æ­£å¸¸çš„æ‰§è¡Œè¿‡ç¨‹
['1', '2', '3'].map((item, index) => {
	return parseInt(item, index)
})
// parseInt('1', 0) // 1
// parseInt('2', 1) // NaN æ²¡æœ‰1è¿›åˆ¶è¿™ä¸€è¯´ï¼Œè¯´ç€è¯´ å‚æ•°äºŒçš„èŒƒå›´æ˜¯ 2~
// parseInt('3', 2) // NaN äºŒè¿›åˆ¶æ²¡æœ‰3

å˜å¼ä¸€ï¼š['10','10','10','10','10'].map(parseInt) // [10, NaN, 2, 3, 4]
å˜å¼äºŒï¼šæ€ä¹ˆå®ç°éƒ½å˜ä¸ºæ•°ç»„å‘¢ï¼Ÿ['10','10','10','10','10'].map(Number); // [10, 10, 10, 10, 10]
```


- â£ï¸æ³¨æ„ï¼šåœ¨radixä¸º undefinedï¼Œæˆ–è€…radixä¸º 0 æˆ–è€…æ²¡æœ‰æŒ‡å®šçš„æƒ…å†µä¸‹ï¼ŒJavaScript ä½œå¦‚ä¸‹å¤„ç†ï¼š
    - å¦‚æœå­—ç¬¦ä¸² string ä»¥"0x"æˆ–è€…"0X"å¼€å¤´, åˆ™åŸºæ•°æ˜¯16 (16è¿›åˆ¶).
    - å¦‚æœå­—ç¬¦ä¸² string ä»¥"0"å¼€å¤´, åŸºæ•°æ˜¯8ï¼ˆå…«è¿›åˆ¶ï¼‰æˆ–è€…10ï¼ˆåè¿›åˆ¶ï¼‰ï¼Œé‚£ä¹ˆå…·ä½“æ˜¯å“ªä¸ªåŸºæ•°ç”±å®ç°ç¯å¢ƒå†³å®šã€‚ECMAScript 5 è§„å®šä½¿ç”¨10ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½éµå¾ªè¿™ä¸ªè§„å®šã€‚å› æ­¤ï¼Œæ°¸è¿œéƒ½è¦æ˜ç¡®ç»™å‡ºradixå‚æ•°çš„å€¼ã€‚
    - å¦‚æœå­—ç¬¦ä¸² string ä»¥å…¶å®ƒä»»ä½•å€¼å¼€å¤´ï¼Œåˆ™åŸºæ•°æ˜¯10 (åè¿›åˆ¶)ã€‚

---

### ç¬¬äºŒé¢˜ï¼šä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿï¼ˆï¼‰

**é˜²æŠ–ï¼šä»»åŠ¡é¢‘ç¹è§¦å‘çš„æƒ…å†µä¸‹ï¼Œåªæœ‰ä»»åŠ¡è§¦å‘çš„é—´éš”è¶…è¿‡æŒ‡å®šé—´éš”çš„æ—¶å€™ï¼Œä»»åŠ¡æ‰ä¼šæ‰§è¡Œï¼ˆä¾‹å¦‚æœç´¢æ¡†ï¼Œåªæœ‰å½“ç”¨æˆ·æœç´¢è¾“å…¥å®Œæˆä¹‹åï¼Œåœä¸ªé›¶ç‚¹å‡ ç§’æ‰ä¼šæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¦‚æœåœé¡¿çš„æ—¶é—´å°äºè®¾å®šçš„ï¼Œé‚£å°±è¿˜ä¸æ‰§è¡Œï¼Œè¿™ä¸ªå°±æ˜¯é˜²æŠ–ï¼‰**

```js
function debounce(fn) {
  let timeout = null; // åˆ›å»ºä¸€ä¸ªæ ‡è®°ç”¨æ¥å­˜æ”¾å®šæ—¶å™¨çš„è¿”å›å€¼
  return function () {
    clearTimeout(timeout); // æ¯å½“ç”¨æˆ·è¾“å…¥çš„æ—¶å€™æŠŠå‰ä¸€ä¸ª setTimeout clear æ‰
    timeout = setTimeout(() => { // ç„¶ååˆåˆ›å»ºä¸€ä¸ªæ–°çš„ setTimeout, è¿™æ ·å°±èƒ½ä¿è¯è¾“å…¥å­—ç¬¦åçš„ interval é—´éš”å†…å¦‚æœè¿˜æœ‰å­—ç¬¦è¾“å…¥çš„è¯ï¼Œå°±ä¸ä¼šæ‰§è¡Œ fn å‡½æ•°
      fn.apply(this, arguments);
    }, 500);
  };
}

debounce(fn) // ä½¿ç”¨

```

---

**èŠ‚æµï¼šæŒ‡å®šæ—¶é—´é—´éš”å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼ˆä¾‹å¦‚ä¸€ä¸ªä¸€ç§’å†…è¿ç»­è§¦å‘çš„äº‹ä»¶ï¼Œå¦‚æœç”¨äº†èŠ‚æµï¼Œè®©å…¶300msè§¦å‘ä¸€æ¬¡ï¼Œé‚£ä¹ˆ1så°±åªèƒ½è§¦å‘3æ¬¡ï¼‰**

```js
function throttle(fn) {
  let canRun = true; // é€šè¿‡é—­åŒ…ä¿å­˜ä¸€ä¸ªæ ‡è®°
  return function () {
    if (!canRun) return; // åœ¨å‡½æ•°å¼€å¤´åˆ¤æ–­æ ‡è®°æ˜¯å¦ä¸ºtrueï¼Œä¸ä¸ºtrueåˆ™return
    canRun = false; // ç«‹å³è®¾ç½®ä¸ºfalse
    setTimeout(() => { // å°†å¤–éƒ¨ä¼ å…¥çš„å‡½æ•°çš„æ‰§è¡Œæ”¾åœ¨setTimeoutä¸­
      fn.apply(this, arguments);
      // æœ€ååœ¨setTimeoutæ‰§è¡Œå®Œæ¯•åå†æŠŠæ ‡è®°è®¾ç½®ä¸ºtrue(å…³é”®)è¡¨ç¤ºå¯ä»¥æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯äº†ã€‚å½“å®šæ—¶å™¨æ²¡æœ‰æ‰§è¡Œçš„æ—¶å€™æ ‡è®°æ°¸è¿œæ˜¯falseï¼Œåœ¨å¼€å¤´è¢«returnæ‰
      canRun = true;
    }, 500);
  };
}

throttle(fn) // ä½¿ç”¨
```

[èŠ‚æµå’Œé˜²æŠ–å…¶ä»–å¥½çš„æ–‡ç« ](https://juejin.im/entry/58c0379e44d9040068dc952f)

---

### ç¬¬ä¸‰é¢˜ï¼šä»‹ç»ä¸‹ Setã€Mapã€WeakSet å’Œ WeakMap çš„åŒºåˆ«ï¼Ÿï¼ˆåŸºæœ¬è¯­æ³•ï¼‰

æ„Ÿè§‰ç†è§£è¿˜æ˜¯ä¼¼æ‡‚éæ‡‚ï¼Œå…³é”®åœ¨äºï¼Œæˆ‘æ²¡æœ‰åº”ç”¨ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜ï¼Œå°±æ˜¯è¿™å‡ ä¸ªçš„å¸¸è§åº”ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

[ç­”æ¡ˆï¼Œä½†æ˜¯è¿˜æ˜¯ä¼¼æ‡‚éæ‡‚](https://github.com/sisterAn/blog/issues/24)

---

### ç¬¬å››é¢˜ï¼šä»‹ç»ä¸‹æ·±åº¦ä¼˜å…ˆéå†å’Œå¹¿åº¦ä¼˜å…ˆéå†ï¼Œå¦‚ä½•å®ç°ï¼Ÿ

è¿™ä¸ªè¿˜æ˜¯åº”è¯¥éƒ¨åˆ†ä¸çŸ¥é“ï¼Œ
è¯„è®ºåŒºæœ‰äººè¯´åº”ç”¨åˆ°äº†æ ‘å½¢ç»„ä»¶ éå†ä¸Š
è€Œä¸”å’Œé€’å½’çš„æ€æƒ³æƒ³ç»“åˆï¼ˆä¾‹å¦‚ï¼šè¯·åˆ†åˆ«ç”¨æ·±åº¦ä¼˜å…ˆæ€æƒ³å’Œå¹¿åº¦ä¼˜å…ˆæ€æƒ³å®ç°ä¸€ä¸ªæ‹·è´å‡½æ•°ï¼Ÿï¼‰

**æ·±åº¦ä¼˜å…ˆéå†DFSï¼ˆä¸æ ‘çš„å…ˆåºéå†æ¯”è¾ƒç±»ä¼¼ï¼‰**

```js
å‡è®¾åˆå§‹çŠ¶æ€æ˜¯å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹å‡æœªè¢«è®¿é—®ï¼Œåˆ™ä»æŸä¸ªé¡¶ç‚¹vå‡ºå‘ï¼Œé¦–å…ˆè®¿é—®è¯¥é¡¶ç‚¹ç„¶åä¾æ¬¡ä»å®ƒçš„å„ä¸ªæœªè¢«è®¿é—®çš„é‚»æ¥ç‚¹å‡ºå‘æ·±åº¦ä¼˜å…ˆæœç´¢éå†å›¾ï¼Œç›´è‡³å›¾ä¸­æ‰€æœ‰å’Œvæœ‰è·¯å¾„ç›¸é€šçš„é¡¶ç‚¹éƒ½è¢«è®¿é—®åˆ°ã€‚è‹¥æ­¤æ—¶å°šæœ‰å…¶ä»–é¡¶ç‚¹æœªè¢«è®¿é—®åˆ°ï¼Œåˆ™å¦é€‰ä¸€ä¸ªæœªè¢«è®¿é—®çš„é¡¶ç‚¹ä½œèµ·å§‹ç‚¹ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹éƒ½è¢«è®¿é—®åˆ°ä¸ºæ­¢
```

**å¹¿åº¦ä¼˜å…ˆéå†BFS**

```js
ä»å›¾ä¸­æŸé¡¶ç‚¹vå‡ºå‘ï¼Œåœ¨è®¿é—®äº†vä¹‹åä¾æ¬¡è®¿é—®vçš„å„ä¸ªæœªæ›¾è®¿é—®è¿‡çš„é‚»æ¥ç‚¹ï¼Œç„¶ååˆ†åˆ«ä»è¿™äº›é‚»æ¥ç‚¹å‡ºå‘ä¾æ¬¡è®¿é—®å®ƒä»¬çš„é‚»æ¥ç‚¹ï¼Œå¹¶ä½¿å¾—â€œå…ˆè¢«è®¿é—®çš„é¡¶ç‚¹çš„é‚»æ¥ç‚¹å…ˆäºåè¢«è®¿é—®çš„é¡¶ç‚¹çš„é‚»æ¥ç‚¹è¢«è®¿é—®ï¼Œç›´è‡³å›¾ä¸­æ‰€æœ‰å·²è¢«è®¿é—®çš„é¡¶ç‚¹çš„é‚»æ¥ç‚¹éƒ½è¢«è®¿é—®åˆ°ã€‚ å¦‚æœæ­¤æ—¶å›¾ä¸­å°šæœ‰é¡¶ç‚¹æœªè¢«è®¿é—®ï¼Œåˆ™éœ€è¦å¦é€‰ä¸€ä¸ªæœªæ›¾è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹ä½œä¸ºæ–°çš„èµ·å§‹ç‚¹ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹éƒ½è¢«è®¿é—®åˆ°ä¸ºæ­¢ã€‚
```

[ç­”æ¡ˆï¼Œè¿˜æ˜¯ä¸å¤§æ‡‚](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/9)


---

### ç¬¬äº”é¢˜ï¼šè¯·åˆ†åˆ«ç”¨æ·±åº¦ä¼˜å…ˆæ€æƒ³å’Œå¹¿åº¦ä¼˜å…ˆæ€æƒ³å®ç°ä¸€ä¸ªæ‹·è´å‡½æ•°ï¼Ÿ

æ€æƒ³è§ ç¬¬å››é¢˜ï¼Œè¿™å— æ·±åº¦ä¼˜å…ˆ å’Œ å¹¿åº¦ä¼˜å…ˆ æˆ‘è¿˜æ²¡æå¤ªæ‡‚


---

### ç¬¬å…­é¢˜ï¼šES5/ES6 çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

- class å£°æ˜ä¼šæå‡ï¼Œä½†ä¸ä¼šåˆå§‹åŒ–èµ‹å€¼ã€‚Foo è¿›å…¥æš‚æ—¶æ€§æ­»åŒºï¼Œç±»ä¼¼äº letã€const å£°æ˜å˜é‡ï¼ˆå°±æ˜¯è¦å…ˆå®šä¹‰ï¼Œæ‰èƒ½ç”¨ï¼‰
- class å£°æ˜å†…éƒ¨ä¼šå¯ç”¨ä¸¥æ ¼æ¨¡å¼
- class çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰éƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼ˆES5é€šè¿‡åŸå‹é“¾çš„å†™æ³•æ˜¯å¯ä»¥æšä¸¾çš„ï¼‰
- å¿…é¡»ä½¿ç”¨ new è°ƒç”¨ class
- ......

**â£ï¸ES5å®ç°ç»§æ‰¿**

```js
// å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿
// é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§, é€šè¿‡åŸå‹é“¾æ¥ç»§æ‰¿æ–¹æ³•
// ä¸å¿…ä¸ºäº†æŒ‡å®šå­ç±»å‹çš„åŸå‹è€Œè°ƒç”¨çˆ¶ç±»å‹çš„æ„é€ å‡½æ•°,æˆ‘ä»¬åªéœ€è¦çˆ¶ç±»å‹çš„ä¸€ä¸ªå‰¯æœ¬è€Œå·²
// æœ¬è´¨ä¸Šå°±æ˜¯ä½¿ç”¨å¯„ç”Ÿå¼ç»§æ‰¿æ¥ç»§æ‰¿è¶…ç±»å‹çš„åŸå‹, ç„¶åå†è®²ç»“æœæŒ‡å®šç»™å­ç±»å‹çš„åŸå‹
function object(o){ // ===Object.create()
  function F(){};
  F.prototype = o;
  return new F();
}
function c1(name) {
  this.name = name;
  this.color = ['red', 'green'];
}
c1.prototype.sayName = function () {
  console.log(this.name);
}
function c2(name, age) {
  c1.call(this, name)
  this.age = age
}
// ç¬¬ä¸€æ­¥:åˆ›å»ºçˆ¶ç±»å‹åŸå‹çš„ä¸€ä¸ªå‰¯æœ¬
// ç¬¬äºŒæ­¥:ä¸ºåˆ›å»ºçš„å‰¯æœ¬æ·»åŠ  constructor å±æ€§, ä»è€Œå¼¥è¡¥å› é‡å†™åŸå‹è€Œå¤±å»çš„é»˜è®¤çš„ constructor å±æ€§
// ç¬¬ä¸‰æ­¥:å°†æ–°åˆ›å»ºçš„å¯¹è±¡(å³å‰¯æœ¬)èµ‹å€¼ç»™å­ç±»å‹çš„åŸå‹
function inheritPrototype(superType, subType) {
  const prototype = object(superType.prototype);
  prototype.constructor = subType;
  subType.prototype = prototype;
}

inheritPrototype(c1, c2);
// c2çš„æ–¹æ³•å¿…é¡»æ”¾åœ¨å¯„ç”Ÿç»§æ‰¿ä¹‹å
c2.prototype.sayAge = function () {
  console.log(this.age);
}
```

---

### ç¬¬ä¸ƒé¢˜ï¼šsetTimeoutã€Promiseã€Async/Await çš„åŒºåˆ«ï¼ˆè€ƒå¯Ÿ å®è§‚ä»»åŠ¡é˜Ÿåˆ— å¾®è§‚ä»»åŠ¡é˜Ÿåˆ—çš„åŒºåˆ«ï¼‰

- è¿™ä¸‰è€…åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„åŒºåˆ«ï¼Œäº‹ä»¶å¾ªç¯ä¸­åˆ†ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—
    - settimeoutçš„å›è°ƒå‡½æ•°æ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œç­‰åˆ°æ‰§è¡Œæ ˆæ¸…ç©ºä»¥åæ‰§è¡Œï¼›
    - promise.then é‡Œçš„å›è°ƒå‡½æ•°ä¼šæ”¾åˆ°ç›¸åº”å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œç­‰å®ä»»åŠ¡é‡Œé¢çš„åŒæ­¥ä»£ç æ‰§è¡Œå®Œå†æ‰§è¡Œï¼›
    - async å‡½æ•°è¡¨ç¤ºå‡½æ•°é‡Œé¢å¯èƒ½ä¼šæœ‰å¼‚æ­¥æ–¹æ³•ï¼Œawaitåé¢è·Ÿä¸€ä¸ªè¡¨è¾¾å¼ï¼Œasyncæ–¹æ³•æ‰§è¡Œæ—¶ï¼Œé‡åˆ°awaitä¼šç«‹å³æ‰§è¡Œè¡¨è¾¾å¼ï¼Œç„¶åæŠŠè¡¨è¾¾å¼åé¢çš„ä»£ç æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œè®©å‡ºæ‰§è¡Œæ ˆè®©åŒæ­¥ä»£ç å…ˆæ‰§è¡Œ

[æ›´è¯¦ç»†çš„ç­”æ¡ˆ](https://github.com/sisterAn/blog/issues/21)

---

### ç¬¬å…«é¢˜ï¼šAsync/Await å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥

Async/Awaitå°±æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œçš„generateå‡½æ•° åˆ©ç”¨generateå‡½æ•°çš„ç‰¹æ€§æŠŠå¼‚æ­¥çš„ä»£ç å†™æˆâ€œåŒæ­¥â€çš„å½¢å¼ã€‚

è¿™ä¸ªè¦çœ‹æ˜ç™½ generateå‡½æ•°


### ç¬¬ä¹é¢˜ï¼šå¼‚æ­¥ç¬”è¯•é¢˜

```js
async function async1() {
    console.log('async1 start');
    await async2();
    console.log('async1 end');
}
async function async2() {
    console.log('async2');
}
console.log('script start');
setTimeout(function() {
    console.log('setTimeout');
}, 0)
async1();
new Promise(function(resolve) {
    console.log('promise1');
    resolve();
}).then(function() {
    console.log('promise2');
});
console.log('script end');
```

---

### ğŸ”¥ç¬¬ä¸ƒï¼Œä¹ é¢˜æ•´ä½“æ€»ç»“ï¼ˆEvent Loopï¼‰

å‰è¨€ä»‹ç»ï¼šæˆ‘ä»¬éƒ½çŸ¥é“ JavaScript æ˜¯ä¸€é—¨ å•çº¿ç¨‹ è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€æ—¶é—´åªèƒ½åšä¸€ä»¶äº‹ï¼Œå®ƒå°±åƒæ˜¯åªæœ‰ä¸€ä¸ªçª—å£çš„é“¶è¡Œï¼Œå®¢æˆ·ä¸å¾—ä¸æ’é˜Ÿä¸€ä¸ªä¸€ä¸ªçš„ç­‰å¾…åŠç†ã€‚åŒç† JavaScript çš„ä»»åŠ¡ä¹Ÿè¦ä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ‰§è¡Œï¼Œå¦‚æœæŸä¸ªä»»åŠ¡ï¼ˆæ¯”å¦‚åŠ è½½é«˜æ¸…å›¾ç‰‡ï¼‰æ˜¯ä¸ªè€—æ—¶ä»»åŠ¡ï¼Œé‚£æµè§ˆå™¨å²‚ä¸å¾—ä¸€ç›´å¡ç€ï¼Ÿä¸ºäº†é˜²æ­¢ä¸»çº¿ç¨‹çš„é˜»å¡ï¼ŒJavaScript æœ‰äº† åŒæ­¥ å’Œ å¼‚æ­¥ çš„æ¦‚å¿µã€‚

**æ•°æ®ç»“æ„**

- æ ˆ (stack): åè¿›å…ˆå‡ºï¼Œå­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹è±¡çš„æŒ‡é’ˆï¼Œæœ‰ push() å’Œ pop() è¿™ä¸¤ä¸ªæ–¹æ³•
- é˜Ÿåˆ— (queue): åè¿›åå‡ºï¼Œæœ‰ shift() å’Œ unshift() è¿™ä¸¤ä¸ªæ–¹æ³•
- å † (heap): å †æ˜¯åŸºäºæ ‘æŠ½è±¡æ•°æ®ç±»å‹çš„ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„

**æµè§ˆå™¨æ ¸å¿ƒæ¦‚å¿µ**

- æ‰§è¡Œæ ˆï¼šå½“æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼ŒJavaScript ä¼šç”Ÿæˆä¸€ä¸ªä¸è¿™ä¸ªæ–¹æ³•å¯¹åº”çš„æ‰§è¡Œç¯å¢ƒï¼Œåˆå«æ‰§è¡Œä¸Šä¸‹æ–‡(context)ã€‚è¿™ä¸ªæ‰§è¡Œç¯å¢ƒä¸­ä¿å­˜ç€è¯¥æ–¹æ³•çš„ç§æœ‰ä½œç”¨åŸŸã€ä¸Šå±‚ä½œç”¨åŸŸ(ä½œç”¨åŸŸé“¾)ã€æ–¹æ³•çš„å‚æ•°ï¼Œä»¥åŠè¿™ä¸ªä½œç”¨åŸŸä¸­å®šä¹‰çš„å˜é‡å’Œ this çš„æŒ‡å‘ï¼Œè€Œå½“ä¸€ç³»åˆ—æ–¹æ³•è¢«ä¾æ¬¡è°ƒç”¨çš„æ—¶å€™ã€‚ç”±äº JavaScript æ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™äº›æ–¹æ³•å°±ä¼šæŒ‰é¡ºåºè¢«æ’åˆ—åœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°æ–¹ï¼Œè¿™ä¸ªåœ°æ–¹å°±æ˜¯æ‰€è°“æ‰§è¡Œæ ˆã€‚
- ä»»åŠ¡é˜Ÿåˆ—ï¼šäº‹ä»¶é˜Ÿåˆ—æ˜¯ä¸€ä¸ªå­˜å‚¨ç€ å¼‚æ­¥ä»»åŠ¡ çš„é˜Ÿåˆ—ï¼Œå…¶ä¸­çš„ä»»åŠ¡ä¸¥æ ¼æŒ‰ç…§æ—¶é—´å…ˆåé¡ºåºæ‰§è¡Œï¼Œæ’åœ¨é˜Ÿå¤´çš„ä»»åŠ¡å°†ä¼šç‡å…ˆæ‰§è¡Œï¼Œè€Œæ’åœ¨é˜Ÿå°¾çš„ä»»åŠ¡ä¼šæœ€åæ‰§è¡Œã€‚äº‹ä»¶é˜Ÿåˆ—æ¯æ¬¡ä»…æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨è¯¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚æ‰§è¡Œæ ˆåˆ™æ˜¯ä¸€ä¸ªç±»ä¼¼äºå‡½æ•°è°ƒç”¨æ ˆçš„è¿è¡Œå®¹å™¨ï¼Œå½“æ‰§è¡Œæ ˆä¸ºç©ºæ—¶ï¼ŒJS å¼•æ“ä¾¿æ£€æŸ¥äº‹ä»¶é˜Ÿåˆ—ï¼Œå¦‚æœäº‹ä»¶é˜Ÿåˆ—ä¸ä¸ºç©ºçš„è¯ï¼Œäº‹ä»¶é˜Ÿåˆ—ä¾¿å°†ç¬¬ä¸€ä¸ªä»»åŠ¡å‹å…¥æ‰§è¡Œæ ˆä¸­è¿è¡Œã€‚

---

**ğŸ”¥è§£é¢˜ç»†èŠ‚æ”¶è·ğŸ”¥**

- å£è¯€ï¼šåŒæ­¥å…ˆæ‰§è¡Œï¼Œå¼‚æ­¥å…ˆæ‰§è¡Œå¾®é˜Ÿåˆ—ï¼Œå†æ‰§è¡Œå®é˜Ÿåˆ—
- ç»†èŠ‚ç‚¹ï¼šPromise.then æ‰ä¼šæ”¾åˆ°å¾®é˜Ÿåˆ—ä¸­ !!!ï¼ˆæ­¤é¢˜å’Œä¸Šä¸€é“é¢˜ç®€ç›´æ‰¿ä¸Šå¯ä¸‹ï¼‰
- ç»†èŠ‚ç‚¹ï¼šasync/await awaitå‰é¢çš„ä»£ç æ˜¯åŒæ­¥ï¼Œawaitåé¢çš„ä»£ç æ˜¯å¼‚æ­¥ï¼ˆè¿™é‡Œå…¶å®æ˜¯è¯­æ³•ç³–ï¼‰
- ç»†èŠ‚ç‚¹ï¼šè¿˜æœ‰å°±æ˜¯å°å¿ƒ return è¿™ä¸ªä¼šè·³å‡ºæŸäº› .then è·‘åˆ°å¤–é¢çš„ .then ä¸Šï¼ˆå¯èƒ½ï¼‰

```js
// ================ async/await å˜æ¢å‰ ===============
async function foo() {
  // await å‰é¢çš„ä»£ç 
  await bar();
  // await åé¢çš„ä»£ç 
}

async function bar() {
  // do something...
}

foo();

// ================ async/await å˜æ¢å ===============

function foo() {
  // await å‰é¢çš„ä»£ç 
  Promise.resolve(bar()).then(() => {
    // await åé¢çš„ä»£ç 
  });
}

function bar() {
  // do something...
}

foo();
```

---

**é¢˜ä¸€**

```js
function async1() {
  console.log('async1 start'); // 2

  Promise.resolve(async2()).then(() => {
    console.log('async1 end'); // 6
  });
}

function async2() {
  console.log('async2'); // 3
}

console.log('script start'); // 1

setTimeout(function() {
  console.log('settimeout'); // 8
}, 0);

async1();

new Promise(function(resolve) {
  console.log('promise1'); // 4
  resolve();
}).then(function() {
  console.log('promise2'); // 7
});
console.log('script end'); // 5

```

- é¦–å…ˆæ‰“å°å‡º script start
- æ¥ç€å°† settimeout æ·»åŠ åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ­¤æ—¶å®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['settimeout']
- ç„¶åæ‰§è¡Œå‡½æ•° async1ï¼Œå…ˆæ‰“å°å‡º async1 startï¼Œåˆå› ä¸º Promise.resolve(async2()) æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œæ‰€ä»¥æ‰“å°å‡º async2ï¼Œæ¥ç€å°† async1 end æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['async1 end']
- æ¥ç€æ‰“å°å‡º promise1ï¼Œå°† promise2 æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['async1 end', promise2]
- æ‰“å°å‡º script end
- å› ä¸ºå¾®ä»»åŠ¡ä¼˜å…ˆçº§é«˜äºå®ä»»åŠ¡ï¼Œæ‰€ä»¥å…ˆä¾æ¬¡æ‰“å°å‡º async1 end å’Œ promise2
- æœ€åæ‰“å°å‡ºå®ä»»åŠ¡ settimeout

---

**é¢˜äºŒ**

**è¿™é‡Œæ‰“å°å®Œæˆ then21 æ‰“å° then12 çš„åŸå› æ˜¯ then21è¿›å…¥å¾®é˜Ÿåˆ—ä¹‹åï¼Œè¦ç­‰æ‰§è¡Œå®Œæˆæ‰èƒ½è®© then23è¿›å…¥å¾®é˜Ÿåˆ—ï¼Œè€Œè¿™æ—¶å€™ï¼Œèƒ½è¿›å…¥å¾®é˜Ÿåˆ—çš„åªæœ‰ then12ç¬¦åˆäº†**

```js
const p1 = new Promise((resolve, reject) => {
  console.log('promise1');
  resolve();
})
  .then(() => {
    console.log('then11');
    new Promise((resolve, reject) => {
      console.log('promise2');
      resolve();
    })
      .then(() => {
        console.log('then21');
      })
      .then(() => {
        console.log('then23');
      });
  })
  .then(() => {
    console.log('then12');
  });

const p2 = new Promise((resolve, reject) => {
  console.log('promise3');
  resolve();
}).then(() => {
  console.log('then31');
});
```

- é¦–å…ˆæ‰“å°å‡º promise1
- æ¥ç€å°† then11ï¼Œpromise2 æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['then11', 'promise2']
- æ‰“å°å‡º promise3ï¼Œå°† then31 æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['then11', 'promise2', 'then31']
- ä¾æ¬¡æ‰“å°å‡º then11ï¼Œpromise2ï¼Œthen31ï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º
- å°† then21 å’Œ then12 æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['then21', 'then12']
- ä¾æ¬¡æ‰“å°å‡º then21ï¼Œthen12ï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º
- å°† then23 æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ­¤æ—¶å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸º ['then23']
- æ‰“å°å‡º then23

---

**é¢˜ä¸‰ï¼ˆæ³¨æ„è¿™äº†æœ‰å¤„æœ‰returnï¼Œæ˜¯ä¸ªå°é™·é˜±ï¼‰**

**è¿™å—ç»“åˆä¸Šé¢˜ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼Œè¿™é‡Œæœ‰ returnï¼Œå°±ä¼šè®©è¿™ä¸ª å¾®é˜Ÿåˆ—ä¸­æˆä¸ºä¸€ä¸ªæ•´ä½“ä¹Ÿå°±æ˜¯ [promise2, then12] å…¶ä¸­ promise2è¿˜æœ‰ then21 then23 è¿™æ ·å­**

```js
const p1 = new Promise((resolve, reject) => {
  console.log('promise1'); // 1
  resolve();
})
  .then(() => {
    console.log('then11'); // 2
    return new Promise((resolve, reject) => {
      console.log('promise2'); // 3
      resolve();
    })
      .then(() => {
        console.log('then21'); // 4
      })
      .then(() => {
        console.log('then23'); // 5
      });
  })
  .then(() => {
    console.log('then12'); //6
  });
```

---

- æ¨èæ‹“å±•é˜…è¯»æ–‡ç« ä¸€ï¼š[æœ€åä¸€æ¬¡ææ‡‚ Event Loop](https://www.yanceyleo.com/p/5cbc0ad8ec9b0f4eac13467e)
- æ¨èæ‹“å±•é˜…è¯»æ–‡ç« äºŒï¼š[å¾®ä»»åŠ¡ã€å®ä»»åŠ¡ä¸Event-Loop](https://juejin.im/post/5b73d7a6518825610072b42b#heading-5)

---

â£ï¸æˆ‘ä¹‹å‰çš„å…¶ä»–è§£é‡Š

**JSä¸»çº¿ç¨‹ä¸æ–­çš„å¾ªç¯å¾€å¤çš„ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è¯»å–ä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œå…¶ä¸­è¿è¡Œæœºåˆ¶ç§°ä¸ºäº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰**

- åœ¨é«˜å±‚æ¬¡ä¸Šï¼ŒJavaScript ä¸­æœ‰ **microtasks** å’Œ **macrotasksï¼ˆtaskï¼‰**ï¼Œå®ƒä»¬æ˜¯å¼‚æ­¥ä»»åŠ¡çš„ä¸€ç§ç±»å‹ï¼Œ
- Microtasksçš„ä¼˜å…ˆçº§è¦é«˜äºmacrotasksï¼Œmicrotasks ç”¨äºå¤„ç† I/O å’Œè®¡æ—¶å™¨ç­‰äº‹ä»¶ï¼Œæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªã€‚microtask ä¸º async/await å’Œ Promise å®ç°å»¶è¿Ÿæ‰§è¡Œï¼Œå¹¶åœ¨æ¯ä¸ª task ç»“æŸæ—¶æ‰§è¡Œã€‚åœ¨æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¹‹å‰ï¼Œmicrotask é˜Ÿåˆ—æ€»æ˜¯è¢«æ¸…ç©ºï¼ˆæ‰§è¡Œï¼‰

**ä»–ä»¬å…·æœ‰çš„API**

- microtasksï¼ˆå¾®ä»»åŠ¡ï¼‰
    - process.nextTick
    - promise
    - Object.observe (åºŸå¼ƒ)
    - MutationObserver
- macrotasksï¼ˆå®ä»»åŠ¡ï¼‰
    - setTimeout
    - setImmediate
    - setInterval
    - I/O
    - UI æ¸²æŸ“

---

**event loop æ‰§è¡Œè¿‡ç¨‹è§£é‡Š**

- æ¯ä¸€ä¸ª event loop éƒ½æœ‰ä¸€ä¸ª microtask queue
- æ¯ä¸ª event loop ä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªmacrotask queue ( ä¹Ÿå¯ä»¥ç§°ä¸ºtask queue )
- ä¸€ä¸ªä»»åŠ¡ task å¯ä»¥æ”¾å…¥ macrotask queue ä¹Ÿå¯ä»¥æ”¾å…¥ microtask queueä¸­
- æ¯ä¸€æ¬¡event loopï¼Œä¼šé¦–å…ˆæ‰§è¡Œ microtask queueï¼Œ æ‰§è¡Œå®Œæˆåï¼Œä¼šæå– macrotask queue çš„ä¸€ä¸ªä»»åŠ¡åŠ å…¥ microtask queueï¼Œ æ¥ç€ç»§ç»­æ‰§è¡Œmicrotask queueï¼Œä¾æ¬¡æ‰§è¡Œä¸‹å»ç›´è‡³æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚


---

**å†æ¬¡è§£é‡Š**

- JS ä¸»çº¿ç¨‹æ‹¥æœ‰ä¸€ä¸ª æ‰§è¡Œæ ˆï¼ˆåŒæ­¥ä»»åŠ¡ï¼‰ å’Œ ä¸€ä¸ª ä»»åŠ¡é˜Ÿåˆ—ï¼ˆmicrotasks queueï¼‰ï¼Œä¸»çº¿ç¨‹ä¼šä¾æ¬¡æ‰§è¡Œä»£ç 
- jsä¸­ä¸ºäº†é˜²æ­¢çº¿ç¨‹é˜»å¡ï¼Œé˜»æ­¢å…¨å±€ä»£ç çš„æ‰§è¡Œï¼Œè¡ç”Ÿå‡ºå¾ˆå¤šå¼‚æ­¥æ‰§è¡Œè§£å†³æ–¹æ¡ˆï¼Œè¿™äº›æ–¹æ¡ˆéƒ½ä¼šæŒ‰éœ€åŠ è½½åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ä¸­ï¼Œå½“å…¨å±€é˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•åï¼Œå¼€å§‹å¾ªç¯ä» å¾®é˜Ÿåˆ—->å®é˜Ÿåˆ—->å¾®é˜Ÿåˆ—->å®é˜Ÿåˆ—...è¿™ç§æ‰§è¡Œé¡ºåºæ‰§è¡Œä¸‹å»
- å½“ä¸€ä¸ªå®è§‚é˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•ï¼Œç«‹åˆ»æ‰§è¡Œæœ€è¿‘æ·»åŠ çš„å¾®è§‚é˜Ÿåˆ—

**è¾…åŠ©è§£é‡Šå‚è€ƒ**

- setTimeout ä¼šè¢«æ”¾åˆ° macrotasks queue é‡Œé¢
- Promise ä¼šè¢«æ”¾åˆ° microtask queue é‡Œé¢
- æ¯ä¸€æ¬¡event loopï¼Œä¼šé¦–å…ˆæ‰§è¡Œ microtask queueï¼Œ æ‰§è¡Œå®Œæˆåï¼Œä¼šæå– macrotask queue çš„ä¸€ä¸ªä»»åŠ¡åŠ å…¥ microtask queueï¼Œ æ¥ç€ç»§ç»­æ‰§è¡Œmicrotask queueï¼Œä¾æ¬¡æ‰§è¡Œä¸‹å»ç›´è‡³æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚


---

### ç¬¬åé¢˜ï¼šç®—æ³•æ‰‹å†™é¢˜

```js
// å·²çŸ¥å¦‚ä¸‹æ•°ç»„ï¼šç¼–å†™ä¸€ä¸ªç¨‹åºå°†æ•°ç»„æ‰å¹³åŒ–å»å¹¶é™¤å…¶ä¸­é‡å¤éƒ¨åˆ†æ•°æ®ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå‡åºä¸”ä¸é‡å¤çš„æ•°ç»„
var arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10];

// æˆ‘çš„ç­”æ¡ˆ
[... new Set(arr.flat(Infinity))].sort((a, b) => a - b)


```

---

### ç¬¬åä¸€é¢˜ï¼šJS å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹

[JSå¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹](https://github.com/sisterAn/blog/issues/29)

---

### ç¬¬åäºŒé¢˜ï¼šPromise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆ then æ–¹æ³•å‘¢ï¼Ÿ

è¿™é¢˜å› ä¸ºä¹‹å‰æ€»ç»“äº† Event Loop ï¼Œæ‰€ä»¥æˆ‘çŸ¥é“ Promiseæ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œï¼Œ.then .catch . å•¥å•¥çš„æ˜¯å¼‚æ­¥ï¼Œè€Œä¸”æ”¾åˆ°äº†å¾®é˜Ÿåˆ—ä¸­ï¼Œasync/await ä¸­ï¼Œawait å‰é¢çš„æ˜¯åŒæ­¥ï¼Œawait åé¢çš„æ˜¯å¼‚æ­¥ï¼Œå†™æ³•ä¸Šæ˜¯è¿™æ ·ï¼Œä½†æ˜¯å…¶å®æ˜¯ è¯­æ³•ç³–ï¼Œæœ€åè¿˜ä¼šè½¬ä¸º Promise.thençš„å½¢å¼ï¼ˆè¿™é‡Œå…·ä½“å°±ä¸çŸ¥é“äº†ï¼Œå¯ä»¥çœ‹ä¸‹èµ„æ–™ï¼‰

---

### ç¬¬åä¸‰é¢˜ï¼šå¦‚ä½•å®ç°ä¸€ä¸ª newï¼ˆè¿™å—æˆ‘å’‹ç»™å¿˜äº†!!!ï¼‰

- **åŸç†ï¼š**
- é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„å¯¹è±¡ï¼Œç©ºå¯¹è±¡çš„__proto__å±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡
- æŠŠä¸Šé¢åˆ›å»ºçš„ç©ºå¯¹è±¡èµ‹å€¼æ„é€ å‡½æ•°å†…éƒ¨çš„thisï¼Œç”¨æ„é€ å‡½æ•°å†…éƒ¨çš„æ–¹æ³•ä¿®æ”¹ç©ºå¯¹è±¡
- å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªéåŸºæœ¬ç±»å‹çš„å€¼ï¼Œåˆ™è¿”å›è¿™ä¸ªå€¼ï¼Œå¦åˆ™ä¸Šé¢åˆ›å»ºçš„å¯¹è±¡

```js
// å‚æ•°ä¸€æ„é€ å‡½æ•°
function _new(fn, ...arg) {
    const obj = Object.create(fn.prototype);
    const ret = fn.apply(obj, arg);
    return ret instanceof Object ? ret : obj;
}
```

---

### ç¬¬åå››é¢˜ï¼šä¸¤ä¸ªæ•°ç»„åˆå¹¶æˆä¸€ä¸ªæ•°ç»„ï¼ˆåŸºæœ¬ç±»ï¼‰

è¯·æŠŠä¸¤ä¸ªæ•°ç»„ ['A1', 'A2', 'B1', 'B2', 'C1', 'C2', 'D1', 'D2'] å’Œ ['A', 'B', 'C', 'D']ï¼Œåˆå¹¶ä¸º ['A1', 'A2', 'A', 'B1', 'B2', 'B', 'C1', 'C2', 'C', 'D1', 'D2', 'D']ã€‚

```js
// ä¸¤ä¸ªæ•°ç»„åˆå¹¶æˆä¸€ä¸ªæ•°ç»„
let arr1 = ['A1', 'A2', 'B1', 'B2', 'C1', 'C2', 'D1', 'D2']
let arr2 = ['A', 'B', 'C', 'D']

console.log([...arr1, ...arr2].sort())
```

---

### ç¬¬åäº”é¢˜ï¼šæ”¹é€ ä¸‹é¢çš„ä»£ç ï¼Œä½¿ä¹‹è¾“å‡º0 - 9ï¼Œå†™å‡ºä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰è§£æ³•ï¼ˆåŸºæœ¬ç±»ï¼‰

```js
for (var i = 0; i< 10; i++){
	setTimeout(() => {
		console.log(i);
    }, 100)
}

// æ–¹æ³•ä¸€ï¼šå°† var æ¢æˆ letï¼ŒåŸç†æ˜¯é¿å…æ³„æ¼åˆ°å…¨å±€
// æ–¹æ³•äºŒï¼šå¯åŠ¨é—­åŒ… IIEFï¼Œé”æ­»æ¯æ¬¡å¾ªç¯çš„i

```

- [å¤§ä½¬æ›´è¯¦ç»†æ–¹æ³•åœ°å€ï¼Œä½†æ˜¯æ„Ÿè§‰å°±æ˜¯ç§€](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/43#issuecomment-471960211)


---

### ç¬¬åå…­é¢˜ï¼šä½¿ç”¨ sort() å¯¹æ•°ç»„ [3, 15, 8, 29, 102, 22] è¿›è¡Œæ’åºï¼Œè¾“å‡ºç»“æœ

- ç»“æœæ˜¯ï¼š102 15 22 29 3 8 è¿™é¢˜ä¸»è¦è€ƒçš„æ˜¯ä½ çŸ¥ä¸çŸ¥é“ Array.prototype.sort() çš„é»˜è®¤æ’åˆ—é¡ºåºæ˜¯ä»€ä¹ˆï¼Œæ˜¯


---

### ç¬¬åä¸ƒé¢˜ï¼ša.b.c.d å’Œ a['b']['c']['d']ï¼Œå“ªä¸ªæ€§èƒ½æ›´é«˜ï¼Ÿ

- ç­”æ¡ˆæ˜¯ å‰è€…æ€§èƒ½æ›´é«˜ï¼Œç²—æµ…çš„ç†è§£å°±æ˜¯ï¼Œåè€…å¯èƒ½ä¼šä¼ å…¥å˜é‡ï¼Œå†…éƒ¨v8å¼•æ“ä¼šåšé¢å¤–çš„åˆ¤æ–­ï¼Œæ‰€ä»¥æ€§èƒ½ä½ä¸€äº›
- å…¶å®è¿™é“é¢˜æ¶‰åŠå¾ˆæ·±ï¼Œv8åŸç†ï¼ŒASTæ ‘ç­‰ï¼Œå»ºè®®å‚è€ƒæ–‡ç« ï¼š[æ–‡ç« é“¾æ¥](https://github.com/airuikun/Weekly-FE-Interview/issues/19)

---

### ç¬¬åå…«é¢˜ï¼šéšæœºç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 10 çš„æ•´æ•°ç±»å‹çš„æ•°ç»„ï¼Œä¾‹å¦‚ [2, 10, 3, 4, 5, 11, 10, 11, 20]ï¼Œå°†å…¶æ’åˆ—æˆä¸€ä¸ªæ–°æ•°ç»„ï¼Œè¦æ±‚æ–°æ•°ç»„å½¢å¼å¦‚ä¸‹ï¼Œä¾‹å¦‚ [[2, 3, 4, 5], [10, 11], [20]]

```js
// æ•°ç»„åˆ†éš”å‡½æ•°
function chunk( array, size ) {
    let arr = []
    let arrz = []

    array.forEach( (item, i) => {
        arrz.push(item)
        // i % size === size - 1 è¿™ä¸ªå…¬å¼å¾ˆå¥½
        if ( i % size === size - 1 || i == array.length - 1) {
            arr.push(arrz)
            arrz = []
        }
    })
    return arr
}
```

---

### ç¬¬åä¹é¢˜ï¼šå¦‚ä½•æŠŠä¸€ä¸ªå­—ç¬¦ä¸²çš„å¤§å°å†™å–åï¼ˆå¤§å†™å˜å°å†™å°å†™å˜å¤§å†™ï¼‰ï¼Œä¾‹å¦‚ â€™AbC' å˜æˆ 'aBc' 

```js
function processString (s) {
    var arr = s.split('');
    var new_arr = arr.map((item) => {
        // è¿™ä¸ª item === item.toUpperCase() åˆ¤æ–­æ˜¯ å¤§å†™è¿˜æ˜¯å°å†™å¾ˆå¦™
        return item === item.toUpperCase() ? item.toLowerCase() : item.toUpperCase();
    });
    return new_arr.join('');
}
console.log(processString('AbC'));
```

---

### ç¬¬äºŒåé¢˜ï¼šä¸ºä»€ä¹ˆæ™®é€š for å¾ªç¯çš„æ€§èƒ½è¿œè¿œé«˜äº forEach çš„æ€§èƒ½ï¼Œè¯·è§£é‡Šå…¶ä¸­çš„åŸå› ã€‚

- for å¾ªç¯æ²¡æœ‰ä»»ä½•é¢å¤–çš„å‡½æ•°è°ƒç”¨æ ˆå’Œä¸Šä¸‹æ–‡ï¼›
- forEachå‡½æ•°ç­¾åå®é™…ä¸Šæ˜¯ï¼šarray.forEach(function(currentValue, index, arr), thisValue)
- å®ƒä¸æ˜¯æ™®é€šçš„ for å¾ªç¯çš„è¯­æ³•ç³–ï¼Œè¿˜æœ‰è¯¸å¤šå‚æ•°å’Œä¸Šä¸‹æ–‡éœ€è¦åœ¨æ‰§è¡Œçš„æ—¶å€™è€ƒè™‘è¿›æ¥ï¼Œè¿™é‡Œå¯èƒ½æ‹–æ…¢æ€§èƒ½
- è¯´æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯åœ¨ Nodeé‡Œé¢æµ‹è¯•çš„æ—¶å€™ï¼Œ10ä¸‡ä»¥ä¸‹å¾ªç¯ï¼Œ forEach çš„æ€§èƒ½æ˜¯ forçš„åå€ï¼Œåœ¨100ä¸‡è¿™ä¸ªé‡çº§ä¸‹ï¼Œ forEach çš„æ€§èƒ½æ˜¯å’Œforçš„ä¸€è‡´ï¼Œåœ¨1000ä¸‡çº§ä»¥ä¸Šçš„é‡çº§ä¸Š ï¼Œ forEach çš„æ€§èƒ½è¿œè¿œä½äºforçš„æ€§èƒ½

---

### ç¬¬äºŒåä¸€é¢˜ï¼šè¯·å®ç°ä¸€ä¸ª add å‡½æ•°ï¼Œæ»¡è¶³ä»¥ä¸‹åŠŸèƒ½ï¼ˆå‡½æ•°å¼ç¼–ç¨‹èŒƒç•´ï¼Œç­‰æˆ‘å­¦å¥½äº†å†æ•´ âŒï¼‰

```js
add(1); 			// 1
add(1)(2);  	// 3
add(1)(2)(3)ï¼›// 6
add(1)(2, 3); // 6
add(1, 2)(3); // 6
add(1, 2, 3); // 6
```

---

### ğŸ”¥ç¬¬äºŒåäºŒé¢˜ï¼šæœ‰ä»¥ä¸‹ 3 ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•ï¼Œè¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£ï¼ˆåˆ¤æ–­å†…ç½®ç±»å‹ï¼‰

Object.prototype.toString.call() ã€ instanceof ä»¥åŠ Array.isArray()

**1ï¸âƒ£ Object.prototype.toString.call()**

```js
æ¯ä¸€ä¸ªç»§æ‰¿ Object çš„å¯¹è±¡éƒ½æœ‰ toString æ–¹æ³•ï¼Œå¦‚æœ toString æ–¹æ³•æ²¡æœ‰é‡å†™çš„è¯ï¼Œä¼šè¿”å› [Object type]ï¼Œå…¶ä¸­ type ä¸ºå¯¹è±¡çš„ç±»å‹ã€‚ä½†å½“é™¤äº† Object ç±»å‹çš„å¯¹è±¡å¤–ï¼Œå…¶ä»–ç±»å‹ç›´æ¥ä½¿ç”¨ toString æ–¹æ³•æ—¶ï¼Œä¼šç›´æ¥è¿”å›éƒ½æ˜¯å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨callæˆ–è€…applyæ–¹æ³•æ¥æ”¹å˜toStringæ–¹æ³•çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚

const an = ['Hello','An'];
an.toString(); // "Hello,An"
Object.prototype.toString.call(an); // "[object Array]"

// è¿™ç§æ–¹æ³•å¯¹äºæ‰€æœ‰åŸºæœ¬çš„æ•°æ®ç±»å‹éƒ½èƒ½è¿›è¡Œåˆ¤æ–­ï¼Œå³ä½¿æ˜¯ null å’Œ undefined ã€‚

Object.prototype.toString.call('An') // "[object String]"
Object.prototype.toString.call(1) // "[object Number]"
Object.prototype.toString.call(Symbol(1)) // "[object Symbol]"
Object.prototype.toString.call(null) // "[object Null]"
Object.prototype.toString.call(undefined) // "[object Undefined]"
Object.prototype.toString.call(function(){}) // "[object Function]"
Object.prototype.toString.call({name: 'An'}) // "[object Object]"

// Object.prototype.toString.call() å¸¸ç”¨äºåˆ¤æ–­æµè§ˆå™¨å†…ç½®å¯¹è±¡æ—¶ã€‚
```

---

**2ï¸âƒ£ instanceof**

instanceof  çš„å†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯ä¸æ˜¯èƒ½æ‰¾åˆ°ç±»å‹çš„ prototypeã€‚

```js
[]  instanceof Array; // true
[]  instanceof Object; // true
```

---

**3ï¸âƒ£ Array.isArray()**

- å½“æ£€æµ‹Arrayå®ä¾‹æ—¶ï¼ŒArray.isArray ä¼˜äº instanceof
- Array.isArray()æ˜¯ES5æ–°å¢çš„æ–¹æ³•ï¼Œå½“ä¸å­˜åœ¨ Array.isArray() ï¼Œå¯ä»¥ç”¨ Object.prototype.toString.call() å®ç°

```js
var iframe = document.createElement('iframe');
document.body.appendChild(iframe);
xArray = window.frames[window.frames.length-1].Array;
var arr = new xArray(1,2,3); // [1,2,3]

// Correctly checking for Array
Array.isArray(arr);  // true
Object.prototype.toString.call(arr); // true
// Considered harmful, because doesn't work though iframes
arr instanceof Array; // false
```

---


